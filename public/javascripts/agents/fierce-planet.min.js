var INITIAL_HEALTH=100,MOVE_INCREMENTS=5;function AgentType(a,b){this._name=a;this._color=b;this._speed=MOVE_INCREMENTS;this._health=INITIAL_HEALTH;this._drawFunction=null}AgentType.prototype.getName=function(){return this._name};AgentType.prototype.getColor=function(){return this._color};AgentType.prototype.getHealth=function(){return this._health};AgentType.prototype.getDrawFunction=function(){return this._drawFunction};AgentType.prototype.setDrawFunction=function(a){this._drawFunction=a};
function Memory(a,b,c,d){this._agentID=a;this._mostRecentVisit=this._age=b;this._visits=1;this._x=c;this._y=d;this._distanceFromLastUntriedPath=-1}Memory.prototype.getAgentID=function(){return this._agentID};Memory.prototype.getAge=function(){return this._age};Memory.prototype.setAge=function(a){this._age=a};Memory.prototype.getX=function(){return this._x};Memory.prototype.setX=function(a){this._x=a};Memory.prototype.getY=function(){return this._y};Memory.prototype.setY=function(a){this._y=a};
Memory.prototype.getVisits=function(){return this._visits};Memory.prototype.setVisits=function(a){this._visits=a};Memory.prototype.addVisit=function(a,b){this._agentID=a;this._mostRecentVisit=b;this._visits++};Memory.prototype.getMostRecentVisit=function(){return this._mostRecentVisit};Memory.prototype.setMostRecentVisit=function(a){this._mostRecentVisit=a};Memory.prototype.getDistanceFromLastUntriedPath=function(){return this._distanceFromLastUntriedPath};
Memory.prototype.setDistanceFromLastUntriedPath=function(a){this._distanceFromLastUntriedPath=a};MemoryOfAgent.prototype=new Memory;MemoryOfAgent.prototype.constructor=MemoryOfAgent;function MemoryOfAgent(a,b,c,d,e){this._agentID=a;this._age=b;this._x=c;this._y=d;this._visits=1;this._otherAgentID=e;this._distanceFromLastUntriedPath=-1}MemoryOfAgent.prototype.getOtherAgentID=function(){return this._otherAgentID};
function Agent(a,b,c){this._agentType=a;this._color=a.getColor();this._id=this.generateID();this._age=0;this._x=b;this._y=c;this._chronologicalMemory=[];this._memoriesOfPlacesVisited=[];this._memoriesOfPathsUntried=[];this._canCommunicateWithOtherAgents=!0;this._memoriesOfPlacesVisitedByOtherAgents=[];this._memoriesOfPathsUntriedByOtherAgents=[];this._memoriesOfResources=[];this._memoriesOfAgents=[];this._lastUntriedPathMemory=this._lastMemory=null;this.memorise(void 0,b,c);this._wanderY=this._wanderX=
this._delay=0;this._speed=MOVE_INCREMENTS;this._countdownToMove=0;this._health=INITIAL_HEALTH;this._healthCategoryStats={};this.registerHealthStats();this._isHit=!1}Agent.prototype.generateID=function(){return Math.floor(Math.random()*Math.pow(10,10))};Agent.prototype.getID=function(){return this._id};Agent.prototype.getAge=function(){return this._age};Agent.prototype.setAge=function(a){this._age=a};Agent.prototype.getPosition=function(){return[this._x,this._y]};
Agent.prototype.setPosition=function(a,b){this._x=a;this._y=b};Agent.prototype.lastPosition=function(){return this.getLastMemory()};Agent.prototype.getX=function(){return this._x};Agent.prototype.setX=function(a){this._x=a};Agent.prototype.getY=function(){return this._y};Agent.prototype.setY=function(a){this._y=a};Agent.prototype.getLastMemory=function(){return this._lastMemory};Agent.prototype.setLastMemory=function(a){this._lastMemory=a};Agent.prototype.getMemories=function(){return this._memoriesOfPlacesVisited};
Agent.prototype.setMemories=function(a){this._memoriesOfPlacesVisited=a};Agent.prototype.getCanCommunicateWithOtherAgents=function(){return this._canCommunicateWithOtherAgents};Agent.prototype.setCanCommunicateWithOtherAgents=function(a){this._canCommunicateWithOtherAgents=a};Agent.prototype.getType=function(){return this._agentType};Agent.prototype.getColor=function(){return this._color};Agent.prototype.setColor=function(a){this._color=a};Agent.prototype.getDelay=function(){return this._delay};
Agent.prototype.setDelay=function(a){this._delay=a};Agent.prototype.getHealth=function(){return this._health};Agent.prototype.setHealth=function(a){this._health=a};Agent.prototype.getIsHit=function(){return this._isHit};Agent.prototype.setIsHit=function(a){this._isHit=a};Agent.prototype.registerHealthStats=function(){for(var a=0;a<FiercePlanet.resourceCategories.length;a++)this._healthCategoryStats[FiercePlanet.resourceCategories[a].getCode()]=INITIAL_HEALTH};
Agent.prototype.adjustHealth=function(a){for(var b=FiercePlanet.resourceCategories.length,c=0;c<b;c++){var d=FiercePlanet.resourceCategories[c],e=this._healthCategoryStats[d.getCode()];this._healthCategoryStats[d.getCode()]=this.makeHealthAdjustment(e,a)}this.recalibrateOverallHealth()};Agent.prototype.adjustHealthForResource=function(a,b){var c=b.getCategory().getCode();this._healthCategoryStats[c]=this.makeHealthAdjustment(this._healthCategoryStats[c],a);this.recalibrateOverallHealth()};
Agent.prototype.makeHealthAdjustment=function(a,b){var c=a+b;return c>0&&c<INITIAL_HEALTH?c:c>0?INITIAL_HEALTH:0};Agent.prototype.recalibrateOverallHealth=function(){for(var a=0,b=FiercePlanet.resourceCategories.length,c=!1,d=0;d<b;d++){var e=this._healthCategoryStats[FiercePlanet.resourceCategories[d].getCode()];e==0&&(c=!0);a+=e}this._health=c?0:a/b};Agent.prototype.getWanderX=function(){return this._wanderX};Agent.prototype.getWanderY=function(){return this._wanderY};
Agent.prototype.adjustWander=function(){var a=this._wanderX,b=this._wanderY,c=FiercePlanet.cellWidth/2-FiercePlanet.pieceWidth/2,d=Math.floor(Math.random()*3-1);a+=Math.floor(Math.random()*3-1);b+=d;if(c-Math.abs(a)>=0)this._wanderX=a;if(c-Math.abs(b)>=0)this._wanderY=b};Agent.prototype.getCountdownToMove=function(){return this._countdownToMove};Agent.prototype.setCountdownToMove=function(a){this._countdownToMove=a};Agent.prototype.incrementCountdownToMove=function(){this._countdownToMove++};
Agent.prototype.resetCountdownToMove=function(){this._countdownToMove=0};Agent.prototype.readyToMove=function(){return this._countdownToMove==0};Agent.prototype.getSpeed=function(){return this._speed};Agent.prototype.setSpeed=function(a){this._speed=a};Agent.prototype.getMoves=function(){return this._age};Agent.prototype.setMoves=function(a){this._age=a};Agent.prototype.incrementMoves=function(){this._age++};
Agent.prototype.adjustSpeed=function(){var a=this._speed,a=this._speed-MOVE_INCREMENTS,b=Math.floor(Math.random()*3*Math.pow(Math.abs(a)+1,2)-1),b=b<0?-1:b>0?1:0,a=this._speed+(a>0?-b:b)*1;if(a>0)this._speed=a};Agent.prototype.evaluateMove=function(a,b){var c=this.findPosition(a,b.withNoRepeat,b.withNoCollision,a.getAllowOffscreenCycling());this.setPosition(c[0],c[1]);this.incrementMoves()};Agent.prototype.evaluatePosition=function(a){this.memorise(a,this._x,this._y)};
Agent.prototype.memorise=function(a,b,c){var d=null;this._memoriesOfPlacesVisited[[b,c]]!=void 0?(d=this._memoriesOfPlacesVisited[[b,c]],d.addVisit(this._id,this._age)):(d=new Memory(this._id,this._age,b,c),this._memoriesOfPlacesVisited[[b,c]]=d);this._memoriesOfPathsUntried[[b,c]]!=void 0&&delete this._memoriesOfPathsUntried[[b,c]];this._lastUntriedPathMemory!=void 0&&d.setDistanceFromLastUntriedPath(this._age-this._lastUntriedPathMemory.getAge());this._lastMemory=d;this._chronologicalMemory[this._age]=
d;if(a!=void 0){for(var e=a.getResources(),d=0;d<e.length;d++){var f=e[d],g=f.getX(),h=f.getY();Math.abs(g-b)*Math.abs(h-c)<=1&&(this._memoriesOfResources[[b,c]]=f)}if(b-1>=0&&a.getTile(b-1,c)==void 0&&this._memoriesOfPlacesVisited[[b-1,c]]==void 0)this._lastUntriedPathMemory=new Memory(this._id,this._age,b-1,c),this._memoriesOfPathsUntried[[b-1,c]]=this._lastUntriedPathMemory;if(b+1<a.getWorldWidth()&&a.getTile(b+1,c)==void 0&&this._memoriesOfPlacesVisited[[b+1,c]]==void 0)this._lastUntriedPathMemory=
new Memory(this._id,this._age,b+1,c),this._memoriesOfPathsUntried[[b+1,c]]=this._lastUntriedPathMemory;if(c-1>=0&&a.getTile(b,c-1)==void 0&&this._memoriesOfPlacesVisited[[b,c-1]]==void 0)this._lastUntriedPathMemory=new Memory(this._id,this._age,b,c-1),this._memoriesOfPathsUntried[[b,c-1]]=this._lastUntriedPathMemory;if(c+1<a.getWorldHeight()&&a.getTile(b,c+1)==void 0&&this._memoriesOfPlacesVisited[[b,c+1]]==void 0)this._lastUntriedPathMemory=new Memory(this._id,this._age,b,c+1),this._memoriesOfPathsUntried[[b,
c+1]]=this._lastUntriedPathMemory;if(this._canCommunicateWithOtherAgents){a=a.getCurrentAgents();for(e=0;e<a.length;e++)if(f=a[e],f._id!=this._id&&(g=f.getX(),h=f.getY(),(f.lastPosition().getX()!=this.lastPosition().getX()||f.lastPosition().getY()!=this.lastPosition().getY())&&Math.abs(g-b)<=1&&Math.abs(h-c)<=1)){this._memoriesOfAgents[f._id]=new MemoryOfAgent(this._id,this._age,b,c,f._id);h=[];for(d in f._memoriesOfPlacesVisited)g=f._memoriesOfPlacesVisited[d],g!=void 0&&(h[[g.getX(),g.getY()]]=
new Memory(g.getAgentID(),g.getAge(),g.getX(),g.getY()));this._memoriesOfPlacesVisitedByOtherAgents[f._id]=h;h=[];for(d in f._memoriesOfPathsUntried)g=f._memoriesOfPathsUntried[d],g!=void 0&&(h[[g.getX(),g.getY()]]=new Memory(g.getAgentID(),g.getAge(),g.getX(),g.getY()));this._memoriesOfPathsUntriedByOtherAgents[f._id]=h}}}};
Agent.prototype.findPosition=function(a,b,c,d){for(var e=this.getPosition()[0],f=this.getPosition()[1],g=e,h=f,j=this.lastPosition().getX(),k=this.lastPosition().getY(),c=[],n=this.randomDirectionOrder(),l=0;l<n.length;l++){var g=e,h=f,p=a._worldWidth-1,q=a._worldHeight-1,o=!1;switch(n[l]){case 0:e==0?d?g=p:o=!0:g-=1;break;case 1:e==p?d?g=0:o=!0:g+=1;break;case 2:f==0?d?h=q:o=!0:h-=1;break;case 3:f==q?d?h=0:o=!0:h+=1}b&&j==g&&k==h||o||a.getCell(g,h)==void 0&&c.push([g,h])}if(c.length==0)return[j,
k];g=[];for(l=0;l<c.length;l++){b=c[l];if(a.isExitPoint(b[0],b[1]))return b;if(this._memoriesOfPlacesVisited[b]==void 0){h=!1;if(this._canCommunicateWithOtherAgents)for(var r in this._memoriesOfPlacesVisitedByOtherAgents)d=this._memoriesOfPlacesVisitedByOtherAgents[r],d[b]!=void 0&&(h=!0);h||g.push(b)}}if(g.length>0){j=g[0];for(l=0;l<g.length;l++)if(b=g[l],this.hasNeighbouringResources(a,b[0],b[1])!=null){j=b;break}return j}(e!=j||f!=k)&&c.push([j,k]);if(c.length>1){var a=-1,j=null,k=-1,g=null,h=
[],m;for(m in this._memoriesOfPlacesVisited)h[m]=this._memoriesOfPlacesVisited[m];if(this._canCommunicateWithOtherAgents)for(m in this._memoriesOfPlacesVisitedByOtherAgents)for(f in e=this._memoriesOfPlacesVisitedByOtherAgents[m],e)h[f]=e[f];for(l=0;l<c.length;l++){b=c[l];m=this._memoriesOfPlacesVisited[b];f=e=-1;p=0;if(m!=void 0){m.getAge();var n=m.getMostRecentVisit(),s;for(s in this._memoriesOfPathsUntried){o=this._memoriesOfPathsUntried[s];if(o!=void 0){q=!1;if(this._canCommunicateWithOtherAgents)for(r in this._memoriesOfPlacesVisitedByOtherAgents)if(d=
this._memoriesOfPlacesVisitedByOtherAgents[r],d[s]!=void 0){q=!0;break}d=o.getAge();d=Math.abs(n-d);if(f==-1||d<f)f=d;if(!q&&(e==-1||d<e))e=d}p++}}if(this._canCommunicateWithOtherAgents)for(r in this._memoriesOfPlacesVisitedByOtherAgents)if(d=this._memoriesOfPlacesVisitedByOtherAgents[r],p=this._memoriesOfPathsUntriedByOtherAgents[r],p!=void 0&&d!=void 0&&d[b]!=void 0)for(s in q=d[b].getAge(),p)if(d=p[s],h[s]==void 0&&(d=d.getAge(),d=Math.abs(q-d),e==-1||d<e)){if(m!=void 0&&(n=m.getMostRecentVisit(),
o=m.getVisits(),n>q&&o>3))continue;e=d}if(f>-1&&(k==-1||f<k))k=f,g=b;if(e>-1&&(a==-1||e<a))a=e,j=b}if(j==void 0)for(l=0;l<c.length;l++)if(b=c[l],this._memoriesOfPathsUntried[b]!=void 0){j=b;break}j==void 0&&(j=g!=void 0?g:c[0]);return j}return c[0]};
Agent.prototype.getClosestUnvisitedTile=function(a,b){for(var c=-1,d=0;d<this._memoriesOfPlacesVisited.length;d++){var e=this._memoriesOfPlacesVisited[d];e.getX()==a&&e.getY()==b&&(c=d)}c=c>this._memoriesOfPlacesVisited.length/2?c:this._memoriesOfPlacesVisited.length-c;for(d=1;d<c;d++)e.getX()==a&&e.getY()};Agent.prototype.randomDirectionOrder=function(){for(var a=[],b=[0,1,2,3],c=b.length,d=0;d<c;d++){var e=Math.floor(Math.random()*b.length);a.push(b[e]);b.splice(e,1)}return a};
Agent.prototype.hasNeighbouringResources=function(a,b,c){for(var d=0;d<a.getResources().length;d++){var e=FiercePlanet.currentLevel.getResources()[d],f=e.getX(),g=e.getY();if(Math.abs(f-b)<=1&&Math.abs(g-c)<=1)return e}return null};function Catastrophe(a,b,c,d,e){this._kind=a;this._start=b||0;this._duration=c||150;this._effect=d||0.5;this._notice=e||new Notice("A catastrophe is taking place!",void 0,void 0,this._start,this._duration);this._struck=!1}Catastrophe.prototype.strike=function(){if(!this._struck)FiercePlanet.currentLevel.setResources([]),FiercePlanet.clearCanvas("resourceCanvas"),FiercePlanet.drawResources(),FiercePlanet.currentNotice=new Notice("RESOURCES WIPED OUT!"),this._struck=!0};function Level(a){this._id=a;this._isPresetLevel=!1;this._name=a;this._initialAgentNumber=1;this._entryPoints=[];this._exitPoints=[];this._worldHeight=this._worldWidth=11;this._waveNumber=10;this._expiryLimit=20;this._initialResourceStore=100;this._customLevel=this._allowResouresOnPath=this._allowOffscreenCycling=!1;this._noticeImage=this._mapURL=this._mapOptions=null;this._tiles=[];this._tileMap=[];this._levelAgents=[];this._waveAgents=[];this._currentAgents=[];this._currentAgentsMap=[];this._cells=
[];this._resources=[];this._tip=this._catastrophe=null;this._introduction="Welcome to level "+this._id+".";this._conclusion="Congratulations! You have completed level "+this._id+".";this._soundSrc=this._noticeImage=null}Level.prototype.getId=function(){return this._id};Level.prototype.setId=function(a){this._id=a};Level.prototype.isPresetLevel=function(){return this._isPresetLevel};Level.prototype.setPresetLevel=function(a){this._isPresetLevel=a};Level.prototype.getName=function(){return this._name};
Level.prototype.setName=function(a){this._name=a};Level.prototype.getInitialAgentNumber=function(){return this._initialAgentNumber};Level.prototype.setInitialAgentNumber=function(a){this._initialAgentNumber=a};Level.prototype.getEntryPoints=function(){return this._entryPoints};Level.prototype.setEntryPoints=function(a){this._entryPoints=a};
Level.prototype.addEntryPoint=function(a,b){for(var c=!1,d=0;d<this._entryPoints.length;d++){var e=this._entryPoints[d];if(e[0]==a&&e[1]==b){c=!0;break}}c||this._entryPoints.push([a,b])};Level.prototype.resetEntryPoints=function(){this._entryPoints=[];this.addEntryPoint(0,0)};Level.prototype.removeEntryPoint=function(a,b){for(var c=-1,d=0;d<this._entryPoints.length;d++){var e=this._entryPoints[d];e[0]==a&&e[1]==b&&(c=d)}c>-1&&this._entryPoints.splice(c,1)};Level.prototype.getFirstEntryPoint=function(){return this._entryPoints[0]};
Level.prototype.getExitPoints=function(){return this._exitPoints};Level.prototype.setExitPoints=function(a){this._exitPoints=a};Level.prototype.isExitPoint=function(a,b){for(var c=0;c<this._exitPoints.length;c++){var d=this._exitPoints[c];if(d[0]==a&&d[1]==b)return!0}return!1};Level.prototype.addExitPoint=function(a,b){for(var c=!1,d=0;d<this._exitPoints.length;d++){var e=this._exitPoints[d];if(e[0]==a&&e[1]==b){c=!0;break}}c||this._exitPoints.push([a,b])};
Level.prototype.resetExitPoints=function(){this._exitPoints=[]};Level.prototype.removeExitPoint=function(a,b){for(var c=-1,d=0;d<this._exitPoints.length;d++){var e=this._exitPoints[d];e[0]==a&&e[1]==b&&(c=d)}c>-1&&this._exitPoints.splice(c,1)};Level.prototype.getInitialResourceStore=function(){return this._initialResourceStore};Level.prototype.setInitialResourceStore=function(a){this._initialResourceStore=a};Level.prototype.getWorldWidth=function(){return this._worldWidth};
Level.prototype.setWorldWidth=function(a){this._worldWidth=a};Level.prototype.getWorldHeight=function(){return this._worldHeight};Level.prototype.setWorldHeight=function(a){this._worldHeight=a};Level.prototype.getWaveNumber=function(){return this._waveNumber};Level.prototype.setWaveNumber=function(a){this._waveNumber=a};Level.prototype.getExpiryLimit=function(){return this._expiryLimit};Level.prototype.setExpiryLimit=function(a){this._expiryLimit=a};Level.prototype.getAllowOffscreenCycling=function(){return this._allowOffscreenCycling};
Level.prototype.setAllowOffscreenCycling=function(a){this._allowOffscreenCycling=a};Level.prototype.getAllowResourcesOnPath=function(){return this._allowResouresOnPath};Level.prototype.setAllowResourcesOnPath=function(a){this._allowResouresOnPath=a};Level.prototype.getIntroduction=function(){return this._introduction};Level.prototype.setIntroduction=function(a){this._introduction=a};Level.prototype.getConclusion=function(){return this._conclusion};
Level.prototype.setConclusion=function(a){this._conclusion=a};Level.prototype.getTip=function(){return this._tip};Level.prototype.setTip=function(a){this._tip=a};Level.prototype.getImage=function(){return this._noticeImage};Level.prototype.setImage=function(a){this._noticeImage=a};Level.prototype.getSoundSrc=function(){return this._soundSrc};Level.prototype.setSoundSrc=function(a){this._soundSrc=a};Level.prototype.getTile=function(a,b){return this._tiles[b*this.getWorldWidth()+a]};
Level.prototype.getSurroundingTiles=function(a,b){var c=[];a>0&&c.add(this.getTile(a-1,b));a<this._worldWidth-1&&c.add(this.getTile(a+1,b));b>0&&c.add(this.getTile(a,b-1));b<this._worldHeight-1&&c.add(this.getTile(a,b+1));return c};Level.prototype.getTiles=function(){return this._tiles};Level.prototype.setTiles=function(a){this._tiles=a;this.assignCells()};
Level.prototype.addTile=function(a){this._tiles[a._y*this._worldWidth+a._x]=a;this.removeEntryPoint(a._x,a._y);this.removeExitPoint(a._x,a._y);this.addCell(a._x,a._y,a)};Level.prototype.removeTile=function(a,b){this._tiles[b*this.getWorldWidth()+a]=void 0;this.annulCell(a,b)};Level.prototype.removeAllTiles=function(){for(var a=0;a<this.getWorldWidth();a++)for(var b=0;b<this.getWorldHeight();b++)this._tiles[b*this.getWorldWidth()+a]=void 0,this._cells[[a,b]]=void 0};Level.prototype.getMapOptions=function(){return this._mapOptions};
Level.prototype.setMapOptions=function(a){this._mapOptions=a};Level.prototype.getMapURL=function(){return this._mapURL};Level.prototype.setMapURL=function(a){this._mapURL=a};Level.prototype.getBackgroundImage=function(){return this._backgroundImage};Level.prototype.setBackgroundImage=function(a){this._backgroundImage=a};Level.prototype.isCustomLevel=function(){return this._customLevel};Level.prototype.setCustomLevel=function(a){this._customLevel=a};Level.prototype.getLevelAgents=function(){return this._levelAgents};
Level.prototype.setLevelAgents=function(a){this._levelAgents=a};Level.prototype.addLevelAgent=function(a){this._levelAgents.push(a)};Level.prototype.getWaveAgents=function(){return this._waveAgents};Level.prototype.setWaveAgents=function(a){this._waveAgents=a};Level.prototype.addWaveAgent=function(a){this._waveAgents.push(a)};Level.prototype.getCurrentAgents=function(){return this._currentAgents};
Level.prototype.setCurrentAgents=function(a){this._currentAgents=a;for(var b in this._currentAgents)this._currentAgentsMap[b._id]=b};Level.prototype.getAgentByID=function(a){return this._currentAgentsMap[a]};Level.prototype.getResources=function(){return this._resources};Level.prototype.setResources=function(a){this._resources=a};Level.prototype.getCatastrophe=function(){return this._catastrophe};Level.prototype.setCatastrophe=function(a){this._catastrophe=a};Level.prototype.getCells=function(){return this._cells};
Level.prototype.getCell=function(a,b){return this._cells[[a,b]]};Level.prototype.setCells=function(a){this._cells=a};Level.prototype.addCell=function(a,b,c){this._cells[[a,b]]=c};Level.prototype.annulCell=function(a,b){this._cells[[a,b]]=void 0};Level.prototype.assignCells=function(){for(var a=0;a<this._tiles.length;a++){var b=this._tiles[a];b!=void 0&&this.addCell(b._x,b._y,b)}};
Level.prototype.generateWaveAgents=function(a){for(var b=[],c=0;c<a;c++)for(var d=0;d<this._waveAgents.length;d++){var e=this._waveAgents[d];b.push(new Agent(e.getType(),e.getX(),e.getY()))}return b};Level.prototype.getPath=function(){for(var a=[],b=0;b<this._worldHeight;b++)for(var c=0;c<this._worldWidth;c++)this._tiles[b*this._worldWidth+c]==void 0&&a.push([c,b]);return a};
Level.prototype.fillWithTiles=function(){this._tiles=[];for(var a=0;a<this._worldHeight;a++)for(var b=0;b<this._worldWidth;b++){var c=new Tile(DEFAULT_TILE_COLOR,b,a);this._tiles.push(c);this.addCell(c._x,c._y,c)}};Level.prototype.clearTiles=function(a,b){for(var c=a;c<a+b;c++)if(c>=0&&c<this._tiles.length){var d=this._tiles[c];this._tiles[c]=void 0;this.annulCell(d._x,d._y)}};
Level.prototype.presetAgents=function(a,b,c){for(var d=[],e=0;e<this._entryPoints.length;e++)for(var f=this._entryPoints[e],g=f[0],f=f[1],h=0;h<b;h++){var j=new Agent(a,g,f),k=e%3;j.setColor(k==0?"000":k==1?"0f0":"00f");k=parseInt(Math.random()*MOVE_INCREMENTS*5);j.setDelay(k);j.setCanCommunicateWithOtherAgents(c);d.push(j)}$.merge(d,this.generateWaveAgents());$.merge(d,this.getLevelAgents());this.setCurrentAgents(d)};Level.prototype.setup=function(){};function Event(a,b,c,d,e,f){this.type=a;this._source=b;this._event=c;this._time=d;this._levelContext=e;this._data=f}function EventTarget(){this._listeners={}}
EventTarget.prototype={constructor:EventTarget,addListener:function(a,b){typeof this._listeners[a]=="undefined"&&(this._listeners[a]=[]);this._listeners[a].push(b)},fire:function(a){typeof a=="string"&&(a={type:a});if(!a.target)a.target=this;if(!a.type)throw Error("Event object missing 'type' property.");if(this._listeners[a.type]instanceof Array)for(var b=this._listeners[a.type],c=0,d=b.length;c<d;c++)b[c].call(this,a)},removeListener:function(a,b){if(this._listeners[a]instanceof Array)for(var c=
this._listeners[a],d=0,e=c.length;d<e;d++)if(c[d]===b){c.splice(d,1);break}}};
FiercePlanet.hookUpCustomEventListeners=function(){FiercePlanet.eventTarget.addListener("game",function(a){typeof console!="undefined"&&console.log("Game event "+a._event+" logged at:"+a._time)});FiercePlanet.eventTarget.addListener("resource",function(a){var b=a._source;if(a._levelContext.getId()==1){var c=b.getCategory(),a=c.getName(),b=c.getColor(),c=c.getCode();if(FiercePlanet.resourceStatsCount[c]==1)FiercePlanet.currentNotice=new Notice("Well done! You've added your first "+a+" resource!"),
FiercePlanet.currentNotice._height=80,FiercePlanet.currentNotice._foregroundColor="rgba(0, 0, 0)",FiercePlanet.currentNotice._backgroundColor=b}})};function Notice(a,b,c,d,e,f,g,h,j,k,n){this._text=a||"";this._start=d||FiercePlanet.gameCounter;this._duration=e||150;this._x=b||Math.random()*(FiercePlanet.WORLD_WIDTH-FiercePlanet.WAVE_NOTICE_WIDTH);this._y=c||Math.random()*(FiercePlanet.WORLD_HEIGHT-FiercePlanet.WAVE_NOTICE_HEIGHT);this._width=f||FiercePlanet.WAVE_NOTICE_WIDTH;this._height=g||FiercePlanet.WAVE_NOTICE_HEIGHT;this._backgroundColor=h||"rgba(32, 98, 210)";this._foregroundColor=j||"rgba(255, 255, 255)";this._lineWidth=k||2;this._font=
n||"500 14px/2 Unknown Font, sans-serif"};function PlayerClass(a,b){this._name=a;this._savesRequired=b}PlayerClass.prototype.getName=function(){return this._name};PlayerClass.prototype.setName=function(a){this._name=a};PlayerClass.prototype.getSavesRequired=function(){return this._savesRequired};PlayerClass.prototype.setSavesRequired=function(a){this._savesRequired=a};function ResourceCategory(a,b,c){this._name=a;this._code=b;this._color=c;this._types=[];this._evaluateOtherCategoryImpact=function(){return 1}}ResourceCategory.prototype.getColor=function(){return this._color};ResourceCategory.prototype.setColor=function(a){this._color=a};ResourceCategory.prototype.getName=function(){return this._name};ResourceCategory.prototype.setName=function(a){this._name=a};ResourceCategory.prototype.getCode=function(){return this._code};
ResourceCategory.prototype.setCode=function(a){this._code=a};ResourceCategory.prototype.getTypes=function(){return this._types};ResourceCategory.prototype.setTypes=function(a){this._types=a};ResourceCategory.prototype.addType=function(a){this._types.push(a)};ResourceCategory.prototype.setEvaluateOtherCategoryImpact=function(a){this._evaluateOtherCategoryImpact=a};ResourceCategory.prototype.doEvaluateOtherCategoryImpact=function(a){return this._evaluateOtherCategoryImpact(a)};
function ResourceType(a,b,c,d,e,f,g,h){this._category=a;this._name=b;this._code=c;this._image=d;this._cost=e;this._upgradeCost=f;this._totalYield=g;this._perAgentYield=h;this._category.addType(this)}ResourceType.prototype.getName=function(){return this._name};ResourceType.prototype.setName=function(a){this._name=a};ResourceType.prototype.getCode=function(){return this._code};ResourceType.prototype.setCode=function(a){this._code=a};ResourceType.prototype.getImage=function(){return this._image};
ResourceType.prototype.setImage=function(a){this._image=a};ResourceType.prototype.getCategory=function(){return this._category};ResourceType.prototype.setCategory=function(a){this._category=a};ResourceType.prototype.getCost=function(){return this._cost};ResourceType.prototype.setCost=function(a){this._cost=a};ResourceType.prototype.getUpgradeCost=function(){return this._upgradeCost};ResourceType.prototype.setUpgradeCost=function(a){this._upgradeCost=a};ResourceType.prototype.getPerAgentYield=function(){return this._perAgentYield};
ResourceType.prototype.setPerAgentYield=function(a){this._perAgentYield=a};ResourceType.prototype.getTotalYield=function(){return this._totalYield};ResourceType.prototype.setTotalYield=function(a){this._totalYield=a};
function Resource(a,b,c){this._resourceCategory=a.getCategory();this._color=a.getCategory().getColor();this._kind=a;this._resourceName=a.getCode();this._initialTotalYield=a.getTotalYield();this._perAgentYield=a.getPerAgentYield();this._cost=a.getCost();this._upgradeCost=a.getUpgradeCost();this._totalYield=a.getTotalYield();this._upgradeLevel=1;this.setPosition(b,c)}Resource.prototype.getName=function(){return this._resourceName};Resource.prototype.getCategory=function(){return this._resourceCategory};
Resource.prototype.getColor=function(){return this._color};Resource.prototype.getCost=function(){return this._cost};Resource.prototype.setCost=function(a){this._cost=a};Resource.prototype.getUpgradeCost=function(){return this._upgradeCost};Resource.prototype.setUpgradeCost=function(a){this._upgradeCost=a};Resource.prototype.getInitialTotalYield=function(){return this._initialTotalYield};Resource.prototype.setInitialTotalYield=function(a){this._totalYield=this._initialTotalYield=a};
Resource.prototype.getPerAgentYield=function(){return this._perAgentYield};Resource.prototype.setPerAgentYield=function(a){this._perAgentYield=a};Resource.prototype.getUpgradeLevel=function(){return this._upgradeLevel};Resource.prototype.setUpgradeLevel=function(a){this._upgradeLevel=a};Resource.prototype.getTotalYield=function(){return this._totalYield};Resource.prototype.setTotalYield=function(a){this._totalYield=a};Resource.prototype.getPosition=function(){return[this._x,this._y]};
Resource.prototype.setPosition=function(a,b){this._x=a;this._y=b};Resource.prototype.getX=function(){return this._x};Resource.prototype.setX=function(a){this._x=a};Resource.prototype.getY=function(){return this._y};Resource.prototype.setY=function(a){this._y=a};
Resource.prototype.provideYield=function(a,b){if(this._totalYield>this._perAgentYield&&a.getHealth()<100){var c=0;FiercePlanet.applyGeneralHealth?(c=this._perAgentYield*this._upgradeLevel*b,a.adjustHealth(c)):(c=this._perAgentYield*this._upgradeLevel*3*b,a.adjustHealthForResource(c,this));a.setSpeed(this._perAgentYield);this._totalYield-=this._perAgentYield}};var DEFAULT_TILE_COLOR="0FFF1F";function Tile(){this._color="0FFF1F"}function Tile(a){this._color=a}function Tile(a,b,c){this._color=a;this._x=b;this._y=c}Tile.prototype.getColor=function(){return this._color};Tile.prototype.getPosition=function(){return[this._x,this._y]};Tile.prototype.setPosition=function(a,b){this._x=a;this._y=b};Tile.prototype.getX=function(){return this._x};Tile.prototype.setX=function(a){this._x=a};Tile.prototype.getY=function(){return this._y};
Tile.prototype.setY=function(a){this._y=a};var FiercePlanet=FiercePlanet||{};FiercePlanet.calculateWorldLeft=function(){var a=$("#content-pane"),b=$("#world"),a=a.position().left,b=b.position().left;return a+b};
FiercePlanet.setupDialogs=function(){var a=FiercePlanet.calculateWorldLeft();FiercePlanet.$newLevel=$("<div></div>").html("New Level").dialog({position:[a,110],width:487,height:407,autoOpen:!1,modal:!0,title:"New Level",buttons:{Play:function(){$(this).dialog("close");var a=$("#map_canvas, #baseCanvas"),c=$("#world"),d=c.position().left,e=c.position().top,f=c.width(),g=c.height();c.css({width:0,height:0,left:d+Math.floor(Math.random()*f),top:e+Math.floor(Math.random()*g)});c.animate({width:f,height:g,
left:d,top:e},1E3);a.css({width:0,height:0});a.animate({width:f,height:g},1E3);FiercePlanet.newWave()},Cancel:function(){$(this).dialog("close")}}});FiercePlanet.$completeLevel=$("<div></div>").html("Level Complete!").dialog({position:[a,110],width:487,height:407,autoOpen:!1,modal:!0,title:"Level Complete!",buttons:{"Next Level":function(){FiercePlanet.newLevel();$(this).dialog("close")},Cancel:function(){FiercePlanet.newLevel();$(this).dialog("close")}}});FiercePlanet.$completeGame=$("<div></div>").html("Complete game!").dialog({position:[a,
110],width:487,height:407,autoOpen:!1,modal:!0,title:"Fierce Planet Complete!",buttons:{"New Game":function(){FiercePlanet.newGame();$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}});FiercePlanet.$gameOver=$("<div></div>").html("Game Over!").dialog({position:[a,110],width:487,height:407,autoOpen:!1,modal:!0,title:"Game Over!",buttons:{"Restart Level":function(){FiercePlanet.restartLevel();$(this).dialog("close")},"New Game":function(){FiercePlanet.newGame();$(this).dialog("close")}}});
FiercePlanet.$upgradeDelete=$("#delete-upgrade-dialog").dialog({position:[a,110],width:487,height:407,autoOpen:!1,modal:!0,title:"Upgrade or Delete Resource",buttons:{Cancel:function(){$(this).dialog("close")}}});$("#del-button").click(function(){FiercePlanet.deleteCurrentResource();FiercePlanet.$upgradeDelete.dialog("close")});$("#upg-button").click(function(){FiercePlanet.upgradeCurrentResource();FiercePlanet.$upgradeDelete.dialog("close")});FiercePlanet.$resourceGallery=$("#resource-gallery").dialog({position:[a,
110],width:487,height:407,autoOpen:!1,modal:!0,title:"Resource Gallery",buttons:{"Save Capabilities":function(){FiercePlanet.refreshSwatch();FiercePlanet.saveCapabilities();$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}});FiercePlanet.$settingsDialog=$("#settings-dialog").dialog({position:[a,110],width:487,height:407,autoOpen:!1,modal:!0,title:"Settings",buttons:{"Save Settings":function(){FiercePlanet.setAndStoreProperties();$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}});
$("#tutorial").click(function(){FiercePlanet.currentLevelNumber=0;FiercePlanet.currentLevelPreset=!0;FiercePlanet.restartLevel()});FiercePlanet.$statsDialog=$("<div></div>").dialog({position:[a,110],width:487,height:407,autoOpen:!1,modal:!0,title:"Vital Statistics",buttons:{OK:function(){$(this).dialog("close")}}});FiercePlanet.$designFeatures=$("#level-features").dialog({position:[a,110],width:487,height:407,autoOpen:!1,modal:!0,title:"Add design features",buttons:{Cancel:function(){$(this).dialog("close")}}});
FiercePlanet.$editProperties=$("<div></div>").html("Edit level properties").dialog({position:[a,110],width:487,height:407,autoOpen:!1,modal:!0,title:"Edit level properties",buttons:{"Save Level":function(){$(".edit_level_properties").submit();FiercePlanet.drawGame();$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}})};
FiercePlanet.showGameOverDialog=function(){FiercePlanet.determineCreditsAndClass();FiercePlanet.PROFILE_ID!=void 0?FiercePlanet.updateStats(function(){FiercePlanet.openGameOverDialog()}):FiercePlanet.openGameOverDialog()};FiercePlanet.openGameOverDialog=function(){FiercePlanet.$gameOver.html("Unfortunately Fierce Planet has gotten the better of its citizens! Click 'Restart Level' or 'New Game' to try again."+FiercePlanet.generateStats()).dialog("open")};
FiercePlanet.showCompleteGameDialog=function(){FiercePlanet.determineCreditsAndClass();if(FiercePlanet.PROFILE_ID!=void 0){var a=FiercePlanet.compileStats();$.post("/profiles/"+FiercePlanet.PROFILE_ID+"/update_stats",a,function(){FiercePlanet.openCompleteGameDialog()})}else FiercePlanet.openCompleteGameDialog()};
FiercePlanet.openCompleteGameDialog=function(){FiercePlanet.$completeGame.html("Congratulations! In spite of challenges ahead, the citizens of Fierce Planet look forward to a bright and sustainable future!"+FiercePlanet.generateStats()).dialog("open");$("#gotoResourceGallery").click(FiercePlanet.showResourceGallery)};
FiercePlanet.showCompleteLevelDialog=function(){FiercePlanet.determineCreditsAndClass();if(FiercePlanet.PROFILE_ID!=void 0){var a=FiercePlanet.compileStats();$.post("/profiles/"+FiercePlanet.PROFILE_ID+"/update_stats",a,function(){FiercePlanet.openCompleteLevelDialog()})}else FiercePlanet.openCompleteLevelDialog()};FiercePlanet.openCompleteLevelDialog=function(){FiercePlanet.$completeLevel.html("<p>"+FiercePlanet.currentLevel.getConclusion()+"</p>"+FiercePlanet.generateStats()).dialog("open")};
FiercePlanet.showUpgradeDeleteDialog=function(a){for(var b=FiercePlanet.getCurrentPosition(a),c=b.posX,b=b.posY,d=0;d<FiercePlanet.currentLevel.getResources().length;d++){var e=FiercePlanet.currentLevel.getResources()[d];if(e.getX()==c&&e.getY()==b){FiercePlanet.currentResource=e;FiercePlanet.$upgradeDelete.dialog("open");return}}d=FiercePlanet.currentLevel.getTile(c,b);FiercePlanet.tilesMutable?d==void 0?(FiercePlanet.currentLevel.addTile(new Tile(DEFAULT_TILE_COLOR,c,b)),FiercePlanet.drawGame()):
FiercePlanet.currentResourceId!=null?FiercePlanet.dropItem(a):(b=FiercePlanet.getCurrentPosition(a),FiercePlanet.currentLevel.removeTile(b.posX,b.posY),FiercePlanet.drawGame()):FiercePlanet.currentResourceId!=null&&FiercePlanet.dropItem(a)};
FiercePlanet.showResourceGallery=function(){$("#current-profile-class")[0].innerHTML=FiercePlanet.profileClass;$("#current-credits")[0].innerHTML=FiercePlanet.credits;$("#current-capabilities")[0].innerHTML=FiercePlanet.capabilities.join(",");var a=[],b=[];if(FiercePlanet.profileClass=="Novice")a=FiercePlanet.NOVICE_CAPABILITIES;else if(FiercePlanet.profileClass=="Planner")a=FiercePlanet.PLANNER_CAPABILITIES;else if(FiercePlanet.profileClass=="Expert")a=FiercePlanet.EXPERT_CAPABILITIES;else if(FiercePlanet.profileClass==
"Visionary")a=FiercePlanet.VISIONARY_CAPABILITIES;else if(FiercePlanet.profileClass=="Genius")a=FiercePlanet.GENIUS_CAPABILITIES;for(var a=FiercePlanet.GENIUS_CAPABILITIES,c=$(".purchase"),d=0;d<c.length;d++){var e=c[d],f=e.id,f=f.split("-purchase")[0],g=0;$.inArray(f,FiercePlanet.PLANNER_CAPABILITIES)>-1?g=FiercePlanet.CAPABILITY_COSTS[1]:$.inArray(f,FiercePlanet.EXPERT_CAPABILITIES)>-1?g=FiercePlanet.CAPABILITY_COSTS[2]:$.inArray(f,FiercePlanet.VISIONARY_CAPABILITIES)>-1?g=FiercePlanet.CAPABILITY_COSTS[3]:
$.inArray(f,FiercePlanet.GENIUS_CAPABILITIES)>-1&&(g=FiercePlanet.CAPABILITY_COSTS[4]);$.inArray(f,a)>-1&&$.inArray(f,FiercePlanet.capabilities)==-1&&g<FiercePlanet.credits?b.push(e):$("#"+e.id).css("border","1px solid white")}for(d=0;d<b.length;d++)e=b[d],f=e.id,f=f.split("-purchase")[0],g=0,$.inArray(f,FiercePlanet.PLANNER_CAPABILITIES)?g=FiercePlanet.CAPABILITY_COSTS[1]:$.inArray(f,FiercePlanet.EXPERT_CAPABILITIES)?g=FiercePlanet.CAPABILITY_COSTS[2]:$.inArray(f,FiercePlanet.VISIONARY_CAPABILITIES)?
g=FiercePlanet.CAPABILITY_COSTS[3]:$.inArray(f,FiercePlanet.GENIUS_CAPABILITIES)&&(g=FiercePlanet.CAPABILITY_COSTS[4]),e.addEventListener("click",function(a){var b=this.id,c=b.split("-purchase")[0],d=$("#"+b+" > a > img")[0].title;if($.inArray(c,FiercePlanet.capabilities)==-1&&confirm('Purchase item "'+d+'"?'))FiercePlanet.credits-=g,FiercePlanet.capabilities.push(c),$("#current-credits")[0].innerHTML=FiercePlanet.credits,$("#current-capabilities")[0].innerHTML=FiercePlanet.capabilities.join(", "),
$("#"+b).removeClass("active"),$("#"+b).addClass("inactive");a.stopPropagation();return!1},!0),$("#"+e.id).removeClass("inactive"),$("#"+e.id).addClass("active");FiercePlanet.$resourceGallery.dialog("open")};FiercePlanet.showSettings=function(){FiercePlanet.$settingsDialog.dialog("open")};
FiercePlanet.showCredits=function(){FiercePlanet._stopAgents();FiercePlanet.$genericDialog=$("<div></div>").html("<h3>Credits</h3><div class='credits'>Development Director</div><div>Liam Magee</div><div class='credits'>Art &amp; Design</div><div>Steven Harris</div><div class='credits'>Game Conception &amp; Testing</div><div>Joshua Magee</div><div>Jakki Mann</div>").dialog({position:[FiercePlanet.calculateWorldLeft(),110],width:487,height:407,autoOpen:!1,modal:!0,title:"Credits",buttons:{OK:function(){$(this).dialog("close")}}});
FiercePlanet.$genericDialog.dialog("open")};FiercePlanet=FiercePlanet||{};
FiercePlanet.drawGame=function(){$("#map_canvas").empty();FiercePlanet.clearCanvas("baseCanvas");FiercePlanet.clearCanvas("resourceCanvas");FiercePlanet.clearCanvas("scrollingCanvas");FiercePlanet.clearCanvas("noticeCanvas");FiercePlanet.clearCanvas("agentCanvas");FiercePlanet.currentLevel.getMapOptions()!=void 0&&FiercePlanet.currentLevel.getMapOptions().latitude!=void 0&&FiercePlanet.currentLevel.getMapOptions().longitude!=void 0||FiercePlanet.currentLevel.getMapURL()!=void 0&&$.trim(FiercePlanet.currentLevel.getMapURL()).length>
0?FiercePlanet.drawMap():(FiercePlanet.drawTiles(),FiercePlanet.drawBackgroundImage());FiercePlanet.drawPath();FiercePlanet.drawEntryPoints();FiercePlanet.drawExitPoints();FiercePlanet.drawResources();FiercePlanet.drawScrollingLayer();FiercePlanet.drawScoreboard()};FiercePlanet.drawTiles=function(){for(var a=FiercePlanet.currentLevel.getTiles(),b=0;b<a.length;b+=1)a[b]!=void 0&&FiercePlanet.drawTile(a[b])};
FiercePlanet.drawTile=function(a){var b=$("#baseCanvas")[0].getContext("2d"),c=a._x*FiercePlanet.cellWidth,d=a._y*FiercePlanet.cellHeight;b.clearRect(c+1,d+1,FiercePlanet.cellWidth-1,FiercePlanet.cellHeight-1);if(a._y==0||FiercePlanet.currentLevel.getTile(a._x,a._y-1)==void 0){var e=b.createLinearGradient(c,d,c,d+FiercePlanet.cellHeight/4);e.addColorStop(0,"#060");e.addColorStop(1,"#"+a._color);b.fillStyle=e}else b.fillStyle="#"+a._color;b.fillRect(c,d,FiercePlanet.cellWidth,FiercePlanet.cellHeight);
b.strokeStyle="#fff";b.strokeRect(c,d,FiercePlanet.cellWidth,FiercePlanet.cellHeight)};
FiercePlanet.drawPath=function(){for(var a=$("#baseCanvas")[0].getContext("2d"),b=FiercePlanet.currentLevel.getPath(),c=0;c<b.length;c+=1){var d=b[c],e=d[0],f=d[1],d=e*FiercePlanet.cellWidth,g=f*FiercePlanet.cellHeight;a.clearRect(d+1,g+1,FiercePlanet.cellWidth-1,FiercePlanet.cellHeight-1);if(!FiercePlanet.invisiblePath)f==0||FiercePlanet.currentLevel.getTile(e,f-1)!=void 0?(e=a.createLinearGradient(d,g,d,g+FiercePlanet.cellHeight/4),e.addColorStop(0,"#ccc"),e.addColorStop(1,"#eee"),a.fillStyle=e):
a.fillStyle="#eee",a.border="1px #eee solid",a.fillRect(d,g,FiercePlanet.cellWidth,FiercePlanet.cellHeight);a.strokeStyle="#ccc";a.strokeRect(d,g,FiercePlanet.cellWidth,FiercePlanet.cellHeight)}};FiercePlanet.drawBackgroundImage=function(){FiercePlanet.currentLevel.getBackgroundImage()!=void 0&&$("#baseCanvas")[0].getContext("2d").drawImage(FiercePlanet.currentLevel.getImage(),0,0)};
FiercePlanet.handleApiReady=function(){var a={center:new google.maps.LatLng(47.5153,19.0782),mapTypeId:google.maps.MapTypeId.SATELLITE,disableDefaultUI:!0,zoom:18,tilt:45};FiercePlanet.currentLevel!=void 0?(FiercePlanet.currentLevel.getMapOptions().latitude!=void 0&&FiercePlanet.currentLevel.getMapOptions().longitude!=void 0&&(a.center=new google.maps.LatLng(FiercePlanet.currentLevel.getMapOptions().latitude,FiercePlanet.currentLevel.getMapOptions().longitude)),FiercePlanet.currentLevel.getMapOptions().zoom!=
void 0&&(a.zoom=parseInt(FiercePlanet.currentLevel.getMapOptions().zoom)),FiercePlanet.currentLevel.getMapOptions().tilt!=void 0&&(a.tilt=parseInt(FiercePlanet.currentLevel.getMapOptions().tilt)),FiercePlanet.zoomLevel>1&&(a.zoom+=Math.log(FiercePlanet.zoomLevel)/Math.log(1.5)),FiercePlanet.googleMap=new google.maps.Map($("#map_canvas")[0],a),FiercePlanet.currentLevel.getMapOptions().tilt!=void 0&&FiercePlanet.currentLevel.getMapOptions().tilt!="no"&&FiercePlanet.googleMap.setTilt(45)):FiercePlanet.googleMap=
new google.maps.Map($("#map_canvas")[0],a)};
FiercePlanet.drawMap=function(){if(FiercePlanet.currentLevel.getMapOptions()!=void 0&&FiercePlanet.currentLevel.getMapOptions().latitude!=void 0&&FiercePlanet.currentLevel.getMapOptions().longitude!=void 0){var a=document.createElement("script");a.type="text/javascript";a.src="http://maps.google.com/maps/api/js?sensor=false&callback=FiercePlanet.handleApiReady";document.body.appendChild(a)}else FiercePlanet.currentLevel.getMapURL()!=void 0&&$("#map_canvas").prepend('<img src="'+FiercePlanet.currentLevel.getMapURL()+
'"/>').css("image-orientation: 135deg")};
FiercePlanet.drawExitPoints=function(){for(var a=$("#baseCanvas")[0].getContext("2d"),b=0;b<FiercePlanet.currentLevel._exitPoints.length;b++){var c=FiercePlanet.currentLevel._exitPoints[b],d=c[0]*FiercePlanet.cellWidth+FiercePlanet.cellWidth/2,c=c[1]*FiercePlanet.cellHeight+FiercePlanet.cellHeight/2,e=FiercePlanet.pieceWidth/2;a.beginPath();a.arc(d,c,e,0,Math.PI*2,!1);a.closePath();a.strokeStyle="#000";a.stroke();a.fillStyle="#fff";a.fill();var f=(FiercePlanet.currentWave-1)/FiercePlanet.currentLevel._waveNumber;
a.beginPath();a.moveTo(d,c);a.arc(d,c,e,-Math.PI/2,-Math.PI/2+Math.PI*2*f,!1);a.closePath();a.strokeStyle="#000";a.stroke();a.fillStyle="#0f0";a.fill()}};
FiercePlanet.drawEntryPoints=function(){for(var a=$("#baseCanvas")[0].getContext("2d"),b=0;b<FiercePlanet.currentLevel._entryPoints.length;b++){var c=FiercePlanet.currentLevel._entryPoints[b],d=c[0]*FiercePlanet.cellWidth+FiercePlanet.cellWidth/2,c=c[1]*FiercePlanet.cellHeight+FiercePlanet.cellHeight/2,e=FiercePlanet.pieceWidth/2;a.beginPath();a.arc(d,c,e,0,Math.PI*2,!1);a.closePath();a.strokeStyle="#000";a.stroke();a.fillStyle="#0f0";a.fill();var f=(FiercePlanet.currentWave-1)/FiercePlanet.currentLevel._waveNumber;
a.beginPath();a.moveTo(d,c);a.arc(d,c,e,-Math.PI/2,-Math.PI/2+Math.PI*2*f,!1);a.closePath();a.strokeStyle="#000";a.stroke();a.fillStyle="#fff";a.fill()}};
FiercePlanet.drawNotice=function(){if(FiercePlanet.currentNotice!=null){FiercePlanet.clearCanvas("noticeCanvas");var a=$("#noticeCanvas")[0].getContext("2d"),b=FiercePlanet.currentNotice._text,c=FiercePlanet.currentNotice._start,d=FiercePlanet.currentNotice._duration,e=Math.pow((d-(FiercePlanet.levelCounter-c))/d-0.1,0.5),f=FiercePlanet.currentNotice._x,g=FiercePlanet.currentNotice._y,h=FiercePlanet.currentNotice._width,j=FiercePlanet.currentNotice._height,k=FiercePlanet.insertAlpha(FiercePlanet.currentNotice._foregroundColor,
e),e=FiercePlanet.insertAlpha(FiercePlanet.currentNotice._backgroundColor,e),n=FiercePlanet.currentNotice._lineWidth;a.font=FiercePlanet.currentNotice._font;a.lineWidth=n;a.clearRect(f-1,g-1,h+2,j+2);if(!(c>FiercePlanet.levelCounter||c+d<FiercePlanet.levelCounter)){a.beginPath();a.moveTo(f+10,g);a.lineTo(f+h-10,g);a.arcTo(f+h,g,f+h,g+10,10);a.lineTo(f+h,g+j-10);a.arcTo(f+h,g+j,f+h-10,g+j,10);a.lineTo(f+10,g+j);a.arcTo(f,g+j,f,g+j-10,10);a.lineTo(f,g+10);a.arcTo(f,g,f+10,g,10);a.closePath();a.strokeStyle=
k;a.stroke();a.fillStyle=e;a.fill();b=FiercePlanet.getTextLines(a,b,h-20);a.fillStyle=k;for(k=0;k<b.length;k++)a.fillText(b[k],f+10,g+20*(k+1))}}};
FiercePlanet.getTextLines=function(a,b,c){var d=a.measureText(b).width;if(d<c)return[b];for(var d=b.length/Math.ceil(d/c),e=[],b=b.split(" "),f="",g=0;g<b.length;g++){var h=b[g];if(a.measureText(f+h+" ").width<c)f+=h+" ";else if(f.length==0&&a.measureText(h).width>=d){var j=a.measureText(h).width,j=h.length/Math.ceil(j/c);f+=h.substring(0,j-1)+"-";h=h.substring(j,h.length);b.splice(g,0,h);e.push(f);f=""}else e.push(f),f=h+" "}e.push(f);return e};
FiercePlanet.insertAlpha=function(a,b){var c=a;if(a.length==6)var c=a.substring(0,2),d=a.substring(2,4),e=a.substring(4,6),c="rgba("+parseInt(c,16)+", "+parseInt(d,16)+", "+parseInt(e,16)+", "+b+")";else c=a.split(")").join(", "+b+")");return c};FiercePlanet.drawResources=function(){for(var a=0;a<FiercePlanet.currentLevel._resources.length;a+=1)FiercePlanet.drawResource(FiercePlanet.currentLevel._resources[a])};
FiercePlanet.drawResource=function(a){var b=$("#resourceCanvas")[0].getContext("2d"),c=a._x*FiercePlanet.cellWidth,d=a._y*FiercePlanet.cellHeight,e=a._totalYield/a._initialTotalYield*100,e=FiercePlanet.diluteColour(e,e,e,a._color);b.clearRect(c+1,d+1,FiercePlanet.cellWidth-1,FiercePlanet.cellHeight-1);b.fillStyle="#"+e;b.strokeStyle="#333";b.fillRect(c+4,d+4,FiercePlanet.cellWidth-8,FiercePlanet.cellHeight-8);switch(a._upgradeLevel){case 2:b.lineWidth=2;b.strokeStyle="#666";b.strokeRect(c+4,d+4,FiercePlanet.cellWidth-
8,FiercePlanet.cellHeight-8);break;case 3:b.lineWidth=4;b.strokeStyle="#666";b.strokeRect(c+6,d+6,FiercePlanet.cellWidth-12,FiercePlanet.cellHeight-12);break;case 4:b.fillStyle="#666",b.fillRect(c+8,d+8,FiercePlanet.cellWidth-16,FiercePlanet.cellHeight-16)}b.lineWidth=4;b.strokeStyle="#"+e;b.strokeRect(c+2,d+2,FiercePlanet.cellWidth-4,FiercePlanet.cellHeight-4);e=new Image;e.src="/images/"+a._resourceName+".gif";b.drawImage(e,c+4,d+4,FiercePlanet.cellWidth-8,FiercePlanet.cellHeight-8)};
FiercePlanet.clearCanvas=function(a){a=$("#"+a)[0];a.getContext("2d").clearRect(0,0,a.width,a.height)};
FiercePlanet.clearAgents=function(){var a=$("#agentCanvas")[0].getContext("2d"),b=FiercePlanet.currentLevel._currentAgents;if(FiercePlanet.waveCounter>0)for(var c=0;c<b.length;c+=1){var d=b[c],e=d._wanderX,f=d._wanderY,g=FiercePlanet.getDrawingPosition(d,FiercePlanet.waveCounter-1),d=g.intX*FiercePlanet.cellWidth+e+1,g=g.intY*FiercePlanet.cellHeight+f+1;a.clearRect(d,g,FiercePlanet.cellWidth+e+1,FiercePlanet.cellHeight+f+1);if(FiercePlanet.agentTracing)a.beginPath(),a.arc(d+FiercePlanet.cellWidth/
2,g+FiercePlanet.cellHeight*1.2,2,0,Math.PI*2,!1),a.closePath(),a.strokeStyle="#000",a.stroke(),a.fillStyle="#000",a.fill()}};
FiercePlanet.diluteColour=function(a,b,c,d){var e=d.length==3?1:2,f=Math.pow(16,e),g=parseInt(d.slice(0,1*e),16),h=parseInt(d.slice(1*e,2*e),16),d=parseInt(d.slice(2*e,3*e),16),a=Math.floor((100-a)/100*(f-g)),b=Math.floor((100-b)/100*(f-h)),c=Math.floor((100-c)/100*(f-d)),g=(g+a<f?g+a:f-1).toString(16),h=(h+b<f?h+b:f-1).toString(16),f=(d+c<f?d+c:f-1).toString(16),g=g.length<e?g+"0":g,h=h.length<e?h+"0":h,f=f.length<e?f+"0":f;return g+h+f};
FiercePlanet.getAgentDirection=function(a){return a._lastMemory._x<a._x?0:1};
FiercePlanet.getDrawingPosition=function(a){var b=a._lastMemory._x,c=a._lastMemory._y,d=a._x,e=a._y,f=a._speed,g=(f-a._countdownToMove)/f,a=d-(d-b)*g,f=e-(e-c)*g;if(FiercePlanet.currentLevel._allowOffscreenCycling){var h=g<0.5;d==FiercePlanet.worldWidth-1&&b==0?h?(e=(d-FiercePlanet.worldWidth)*g,a=d-e):a=1-g:d==0&&b==FiercePlanet.worldWidth-1?h?a=0-g:(e=(FiercePlanet.worldWidth-b)*g,a=FiercePlanet.worldWidth-e):e==FiercePlanet.worldWidth-1&&c==0?h?(d=(e-FiercePlanet.worldWidth)*g,f=e-d):f=1-g:e==
0&&c==FiercePlanet.worldWidth-1&&(h?f=0-g:(d=(FiercePlanet.worldWidth-c)*g,f=FiercePlanet.worldWidth-d))}return{intX:a,intY:f}};
FiercePlanet.drawAgents=function(){for(var a=$("#agentCanvas")[0].getContext("2d"),b=FiercePlanet.currentLevel._currentAgents,c=0;c<b.length;c+=1){var d=b[c];if(FiercePlanet.rivalsVisible||d._agentType._name!=AgentTypes.RIVAL_AGENT_TYPE._name)if(FiercePlanet.predatorsVisible||d._agentType._name!=AgentTypes.PREDATOR_AGENT_TYPE._name){var e=d._wanderX,f=d._wanderY,g=FiercePlanet.getDrawingPosition(d,FiercePlanet.waveCounter),e=g.intX*FiercePlanet.cellWidth+e+FiercePlanet.cellWidth/2,f=g.intY*FiercePlanet.cellHeight+
f+FiercePlanet.cellHeight/4,g=FiercePlanet.getAgentDirection(d),h=d._healthCategoryStats[FiercePlanet.resourceCategories[0].getCode()],j=d._healthCategoryStats[FiercePlanet.resourceCategories[1].getCode()],k=d._healthCategoryStats[FiercePlanet.resourceCategories[2].getCode()],h=FiercePlanet.diluteColour(k,j,h,d._color.toString());d._isHit&&(h="f00");try{eval(d.getType().getDrawFunction())(a,d,e,f,FiercePlanet.pieceWidth,FiercePlanet.pieceHeight,h,FiercePlanet.waveCounter,g)}catch(n){eval(AgentTypes.CITIZEN_AGENT_TYPE.getDrawFunction())(a,
d,e,f,FiercePlanet.pieceWidth,FiercePlanet.pieceHeight,h,FiercePlanet.waveCounter,g)}}}};
FiercePlanet.drawScrollingLayer=function(){if(FiercePlanet.scrollingImageVisible){FiercePlanet.clearCanvas("scrollingCanvas");var a=$("#scrollingCanvas")[0].getContext("2d");if(FiercePlanet.catastrophesVisible&&FiercePlanet.currentLevel.getCatastrophe()!=void 0){var b=FiercePlanet.currentLevel.getCatastrophe();if(b._notice._start<=FiercePlanet.levelCounter&&b._start+b._duration>=FiercePlanet.levelCounter)FiercePlanet.currentNotice=b._notice;if(b._start<=FiercePlanet.levelCounter&&b._start+b._duration>=
FiercePlanet.levelCounter){FiercePlanet.levelCounter>=(b._start+b._duration)/2&&b.strike();var c=b._duration/FiercePlanet.WORLD_WIDTH,d=FiercePlanet.WORLD_WIDTH-(FiercePlanet.levelCounter-b._start)/c*2,b=(b._start+b._duration-FiercePlanet.levelCounter)/c*2,c=FiercePlanet.WORLD_HEIGHT;a.fillStyle="rgba(128, 128, 255, 0.5)";a.fillRect(d,0,b,c);return}}FiercePlanet.scrollingImageX+FiercePlanet.scrollingImageOffset<480-FiercePlanet.scrollingImageOffset?FiercePlanet.scrollingImageX+=FiercePlanet.scrollingImageOffset:
FiercePlanet.scrollingImageX=1;try{a.drawImage(FiercePlanet.scrollingImage,FiercePlanet.scrollingImageX,1,480,400,0,0,480,400)}catch(e){}}};FiercePlanet.drawLevel=function(){$("#level-display")[0].innerHTML=FiercePlanet.currentLevel.getId()};FiercePlanet.drawProfileClass=function(){var a=$("#profile-class-display")[0];if(a!=void 0)a.innerHTML=FiercePlanet.profileClass};FiercePlanet.drawScore=function(){$("#score-display")[0].innerHTML=FiercePlanet.zeroFill(FiercePlanet.currentScore,5)};
FiercePlanet.drawHighestScore=function(){var a=$("#highest-score-display")[0],b=localStorage.highestScore;b==void 0&&(b=0);a.innerHTML=b.toString()};FiercePlanet.drawResourcesInStore=function(){$("#goodness-display")[0].innerHTML=FiercePlanet.resourcesInStore.toString()};
FiercePlanet.drawExpired=function(){for(var a=$("#expired-citizens")[0],b="",c=0,d=FiercePlanet.currentLevel.getExpiryLimit();c<d;c++)b+=c<FiercePlanet.expiredAgentCount?'<div id="expired-citizen"></div>':'<div id="healthy-citizen"></div>';a.innerHTML=b};FiercePlanet.drawSaved=function(){$("#saved-display")[0].innerHTML=FiercePlanet.savedAgentCount.toString()};FiercePlanet.drawWaves=function(){$("#waves-display")[0].innerHTML=FiercePlanet.currentWave.toString()+" out of "+FiercePlanet.currentLevel.getWaveNumber()};
FiercePlanet.drawScoreboard=function(){FiercePlanet.drawLevel();FiercePlanet.drawScore();FiercePlanet.drawHighestScore();FiercePlanet.drawWaves();FiercePlanet.drawSaved();FiercePlanet.drawExpired();FiercePlanet.drawResourcesInStore()};
FiercePlanet.pan=function(a){for(var b=$("canvas"),c=0;c<b.length;c++){var d=b[c],e=d.getContext("2d");e.clearRect(0,0,d.width,d.height);switch(a){case 0:e.translate(0,10);break;case 1:e.translate(0,-10);break;case 2:e.translate(10,0);break;case 3:e.translate(-10,0);break;case 4:e.translate(-FiercePlanet.panLeftOffset/FiercePlanet.zoomLevel,-FiercePlanet.panTopOffset/FiercePlanet.zoomLevel)}}switch(a){case 0:FiercePlanet.panTopOffset+=10*FiercePlanet.zoomLevel;break;case 1:FiercePlanet.panTopOffset+=
-10*FiercePlanet.zoomLevel;break;case 2:FiercePlanet.panLeftOffset+=10*FiercePlanet.zoomLevel;break;case 3:FiercePlanet.panLeftOffset+=-10*FiercePlanet.zoomLevel;break;case 4:FiercePlanet.panLeftOffset=0,FiercePlanet.panTopOffset=0}FiercePlanet.drawGame()};
FiercePlanet.zoom=function(a){for(var b=$("canvas"),c=0;c<b.length;c++){var d=b[c].getContext("2d");switch(a){case -1:FiercePlanet.zoomLevel>1&&d.scale(1/1.5,1/1.5);break;case 0:d.scale(1/FiercePlanet.zoomLevel,1/FiercePlanet.zoomLevel);break;case 1:FiercePlanet.zoomLevel<10&&d.scale(1.5,1.5)}}switch(a){case -1:FiercePlanet.zoomLevel>1&&(FiercePlanet.zoomLevel*=1/1.5);break;case 0:FiercePlanet.zoomLevel=1;break;case 1:FiercePlanet.zoomLevel<10&&(FiercePlanet.zoomLevel*=1.5)}FiercePlanet.drawGame()};FiercePlanet=FiercePlanet||{};
FiercePlanet.showDesignFeaturesDialog=function(){$("#makeTile").click(function(){var a=new Tile(DEFAULT_TILE_COLOR,FiercePlanet.currentX,FiercePlanet.currentY);FiercePlanet.currentLevel.addTile(a);FiercePlanet.$designFeatures.dialog("close");FiercePlanet.drawGame()});$("#addExitPoint").click(function(){FiercePlanet.currentLevel.addExitPoint(FiercePlanet.currentX,FiercePlanet.currentY);FiercePlanet.$designFeatures.dialog("close");FiercePlanet.drawGame()});$("#addEntryPoint").click(function(){FiercePlanet.currentLevel.removeEntryPoint(0,0);
FiercePlanet.currentLevel.addEntryPoint(FiercePlanet.currentX,FiercePlanet.currentY);FiercePlanet.$designFeatures.dialog("close");FiercePlanet.drawGame()});$("#removeEntryPoint").click(function(){FiercePlanet.currentLevel.removeEntryPoint(FiercePlanet.currentX,FiercePlanet.currentY);FiercePlanet.$designFeatures.dialog("close");FiercePlanet.drawGame()});$("#removeExitPoint").click(function(){FiercePlanet.currentLevel.removeExitPoint(FiercePlanet.currentX,FiercePlanet.currentY);FiercePlanet.$designFeatures.dialog("close");
FiercePlanet.drawGame()});FiercePlanet.$designFeatures.dialog("open")};FiercePlanet.setupLevelEditor=function(){$("#delete-upgrade").hide();$("#swatch").hide();$("#level-editor").show();var a=$("#agentCanvas");a.unbind("click");a.mousedown(FiercePlanet.handleEditorMouseDown);a.mousemove(FiercePlanet.handleEditorMouseMove);a.mouseup(FiercePlanet.handleEditorMouseUp);FiercePlanet.inDesignMode=!0;FiercePlanet._initialiseGame()};
FiercePlanet.handleEditorMouseDown=function(){FiercePlanet.oldTiles=FiercePlanet.currentLevel.getTiles().slice();FiercePlanet.isMouseDown=!0;return!1};FiercePlanet.handleEditorMouseMove=function(a){a.preventDefault&&a.preventDefault();if(FiercePlanet.isMouseDown)FiercePlanet.isMouseMoving=!0,a=FiercePlanet.getCurrentPosition(a),FiercePlanet.currentLevel.removeTile(a.posX,a.posY),FiercePlanet.drawGame();return!1};
FiercePlanet.handleEditorMouseUp=function(a){a.preventDefault&&a.preventDefault();var b=FiercePlanet.getCurrentPosition(a);FiercePlanet.currentX=b.posX;FiercePlanet.currentY=b.posY;FiercePlanet.currentLevel.getTile(FiercePlanet.currentX,FiercePlanet.currentY)==void 0&&!FiercePlanet.isMouseMoving?FiercePlanet.showDesignFeaturesDialog(a):(FiercePlanet.currentLevel.removeTile(FiercePlanet.currentX,FiercePlanet.currentY),FiercePlanet.drawGame());FiercePlanet.isMouseDown=!1;return FiercePlanet.isMouseMoving=
!1};FiercePlanet.cancelLevelEditor=function(){FiercePlanet.inDesignMode=!1;var a=$("#agentCanvas");a.unbind("mousedown",FiercePlanet.handleEditorMouseDown);a.unbind("mousemove",FiercePlanet.handleEditorMouseMove);a.unbind("mouseup",FiercePlanet.handleEditorMouseUp);$("#level-editor").hide();$("#swatch").show()};FiercePlanet.undoAction=function(){FiercePlanet.currentLevel.setTiles(FiercePlanet.oldTiles);FiercePlanet.drawGame()};FiercePlanet.showLevelProperties=function(){FiercePlanet.$editProperties.dialog("open")};
FiercePlanet.refreshTiles=function(){FiercePlanet.currentLevel.fillWithTiles();FiercePlanet.currentLevel.addEntryPoint(0,0);FiercePlanet.drawGame()};FiercePlanet.fillAllTiles=function(){FiercePlanet.currentLevel.removeAllTiles();FiercePlanet.currentLevel.addEntryPoint(0,0);FiercePlanet.drawGame()};FiercePlanet.clearEntryPoints=function(){FiercePlanet.currentLevel.resetEntryPoints();FiercePlanet.drawGame()};FiercePlanet.clearExitPoints=function(){FiercePlanet.currentLevel.resetExitPoints();FiercePlanet.drawGame()};var FiercePlanet=FiercePlanet||{},$fp=$fp||FiercePlanet;$(document).ready(function(){FiercePlanet.loadGame()});
FiercePlanet.processAgents=function(){FiercePlanet.drawScrollingLayer();FiercePlanet.noticesVisible&&FiercePlanet.currentNotice!=void 0&&FiercePlanet.drawNotice(FiercePlanet.currentNotice);if(FiercePlanet.levelDelayCounter<FiercePlanet.NEW_LEVEL_DELAY/FiercePlanet.interval)FiercePlanet.levelDelayCounter++;else if(FiercePlanet.waveDelayCounter<FiercePlanet.NEW_WAVE_DELAY/FiercePlanet.interval)FiercePlanet.waveDelayCounter++;else{FiercePlanet.waveCounter++;FiercePlanet.levelCounter++;FiercePlanet.gameCounter++;
FiercePlanet.clearAgents();for(var a=[],b=0,c=FiercePlanet.currentLevel.getCurrentAgents(),d=0;d<c.length;d++){var e=c[d],f=e.getSpeed(),g=e.getCountdownToMove()%f;FiercePlanet.waveCounter>=e.getDelay()&&g%f==0&&e.evaluatePosition(FiercePlanet.currentLevel)}for(var h={withNoRepeat:!0,withNoCollision:!1},d=0;d<c.length;d++)if(e=c[d],FiercePlanet.rivalsVisible||e.getType()!=AgentTypes.RIVAL_AGENT_TYPE)if(FiercePlanet.predatorsVisible||e.getType()!=AgentTypes.PREDATOR_AGENT_TYPE)if(f=e.getSpeed(),e.getType()==
AgentTypes.CITIZEN_AGENT_TYPE&&b++,FiercePlanet.waveCounter>=e.getDelay()){e.getDelay();g=e.getCountdownToMove()%f;if(g==0){e.getType()==AgentTypes.CITIZEN_AGENT_TYPE&&FiercePlanet.currentLevel.isExitPoint(e.getX(),e.getY())&&(FiercePlanet.currentScore+=FiercePlanet.SAVE_SCORE,FiercePlanet.savedAgentCount++,FiercePlanet.savedAgentThisWaveCount++,a.push(d),FiercePlanet.resourcesInStore+=FiercePlanet.currentWave<5?4:FiercePlanet.currentWave<10?3:FiercePlanet.currentWave<20?2:1,FiercePlanet.drawScore(),
FiercePlanet.drawResourcesInStore(),FiercePlanet.drawSaved());e.evaluateMove(FiercePlanet.currentLevel,h);e.getType()==AgentTypes.CITIZEN_AGENT_TYPE&&(e.resetCountdownToMove(),e.adjustSpeed(),e.adjustWander());if(e.getMoves()>FiercePlanet.maxWaveMoves)FiercePlanet.maxWaveMoves=e.getMoves();if(e.getType()==AgentTypes.CITIZEN_AGENT_TYPE||e.getType()==AgentTypes.RIVAL_AGENT_TYPE)FiercePlanet.godMode||e.adjustHealth(FiercePlanet.MOVE_HEALTH_COST),e.getHealth()<=0?(a.push(d),e.getType()==AgentTypes.CITIZEN_AGENT_TYPE&&
FiercePlanet.expiredAgentCount++,FiercePlanet.drawExpired()):(FiercePlanet.processNeighbouringResources(e),FiercePlanet.processNeighbouringAgents(e))}e.getType()==AgentTypes.CITIZEN_AGENT_TYPE&&e.incrementCountdownToMove()}if(FiercePlanet.expiredAgentCount>=FiercePlanet.currentLevel.getExpiryLimit())return FiercePlanet.gameOver();for(d=a.length-1;d>=0;d-=1)FiercePlanet.currentLevel.getCurrentAgents().splice(a[d],1);if(b==0)if(FiercePlanet.currentWave<FiercePlanet.currentLevel.getWaveNumber())FiercePlanet.completeWave(),
FiercePlanet.newWave();else if(FiercePlanet.currentLevelNumber<PresetLevels.MAX_DEFAULT_LEVELS)FiercePlanet.completeLevel(),FiercePlanet.levelDelayCounter=0;else return FiercePlanet.completeGame();else FiercePlanet.waveCounter%FiercePlanet.resourceRecoveryCycle==0&&FiercePlanet.recoverResources(),FiercePlanet.drawAgents();FiercePlanet.recording&&FiercePlanet.recordWorld()}};
FiercePlanet.processNeighbouringResources=function(a){for(var b=a.getX(),c=a.getY(),d=0;d<FiercePlanet.currentLevel.getResources().length;d++){var e=FiercePlanet.currentLevel.getResources()[d],f=e.getX(),g=e.getY();Math.abs(f-b)<=1&&Math.abs(g-c)<=1&&(f=FiercePlanet.calculateResourceEffect(e),e.provideYield(a,f),FiercePlanet.drawResource(e))}};
FiercePlanet.processNeighbouringAgents=function(a){var b=a.getX(),c=a.getY();a.setIsHit(!1);for(var d=FiercePlanet.currentLevel.getCurrentAgents(),e=0;e<d.length;e++){var f=d[e],g=f.getX(),h=f.getY();Math.abs(g-b)<=1&&Math.abs(h-c)<=1&&!FiercePlanet.godMode&&FiercePlanet.predatorsVisible&&a.getType()==CITIZEN_AGENT_TYPE&&f.getType()==PREDATOR_AGENT_TYPE&&a.setIsHit(!0)}a.getIsHit()&&a.adjustHealth(-10)};FiercePlanet=FiercePlanet||{};
FiercePlanet.hookUpUIEventListeners=function(){$("#playAgents").click(FiercePlanet.playGame);$("#slowDown").click(FiercePlanet.slowDown);$("#speedUp").click(FiercePlanet.speedUp);$("#newGame").click(FiercePlanet.newGame);$("#restartLevel").click(FiercePlanet.restartLevel);$("#showResourceGallery").click(FiercePlanet.showResourceGallery);$("#panUp").click(function(){FiercePlanet.pan(0)});$("#panDown").click(function(){FiercePlanet.pan(1)});$("#panLeft").click(function(){FiercePlanet.pan(2)});$("#panRight").click(function(){FiercePlanet.pan(3)});
$("#panReset").click(function(){FiercePlanet.pan(4)});$("#zoomIn").click(function(){FiercePlanet.zoom(1)});$("#zoomOut").click(function(){FiercePlanet.zoom(-1)});$("#zoomReset").click(function(){FiercePlanet.zoom(0)});$("#settings").click(FiercePlanet.showSettings);$("#credits").click(FiercePlanet.showCredits);$("#debug").click(FiercePlanet.processAgents);$("#replay").click(FiercePlanet.replayWorld);try{$("#showLevelProperties").click(FiercePlanet.showLevelProperties),$("#refreshTiles").click(FiercePlanet.refreshTiles),
$("#fillAll").click(FiercePlanet.fillAllTiles),$("#undoAction").click(FiercePlanet.undoAction),$("#cancelLevelEditor").click(FiercePlanet.cancelLevelEditor),$("#clearEntryPoints").click(FiercePlanet.clearEntryPoints),$("#clearExitPoints").click(FiercePlanet.clearExitPoints)}catch(a){typeof console!="undefined"&&console.log(a)}FiercePlanet.getAndRetrieveProperties();$(document).keydown(FiercePlanet.handleKeyboardShortcuts);$("input, textarea, select, form").focus(function(){$(document).unbind("keydown")}).blur(function(){$(document).keydown(FiercePlanet.handleKeyboardShortcuts)});
$(document).ajaxComplete(function(){$("input, textarea, select, form").focus(function(){$(document).unbind("keydown")}).blur(function(){$(document).keydown(FiercePlanet.handleKeyboardShortcuts)})});$("#agentCanvas").mousewheel(function(a,c){FiercePlanet.zoom(c);a.preventDefault();return!1});$("#agentCanvas").click(FiercePlanet.handleNoticeEvents)};
FiercePlanet.handleKeyboardShortcuts=function(a){if(!a.ctrlKey&&!a.altKey&&!a.metaKey)switch(a.which){case 107:FiercePlanet.zoom(1);break;case 109:FiercePlanet.zoom(-1);break;case 96:FiercePlanet.zoom(0);break;case 37:FiercePlanet.pan(2);break;case 38:FiercePlanet.pan(0);break;case 39:FiercePlanet.pan(3);break;case 40:FiercePlanet.pan(1);break;case 72:FiercePlanet.pan(4);break;case 80:FiercePlanet.playGame();break;case 78:FiercePlanet.newGame();break;case 82:FiercePlanet.restartLevel();break;case 87:FiercePlanet.slowDown();
break;case 70:FiercePlanet.speedUp();break;case 84:$("#tutorial").click();break;case 71:$("#level-gallery").click();break;case 83:FiercePlanet.showSettings();break;case 69:$("#editor").click();break;case 52:a.shiftKey&&FiercePlanet.showResourceGallery()}};
FiercePlanet.addButtonEffects=function(a){var b=a.src;if(b!=void 0){var c=b.split(".");c.splice(c.length-1,0,"down");var d=c.join(".");a.addEventListener("mouseover",function(){a.src=d},!1);a.addEventListener("mouseout",function(){a.src=b},!1);a.addEventListener("mousedown",function(){a.src=d},!1);a.addEventListener("mouseup",function(){a.src=b},!1)}};
FiercePlanet.handleNoticeEvents=function(a){if(FiercePlanet.currentNotice!=null){var b=FiercePlanet.currentNotice,c=b._start,d=b._duration;if(!(c>FiercePlanet.levelCounter||c+d<FiercePlanet.levelCounter)){var c=b._x,d=b._y,e=b._width,b=b._height,f,g;if(a.offsetX||a.offsetX==0)f=a.offsetX,g=a.offsetY;else if(a.layerX||a.layerX==0)f=a.layerX,g=a.layerY;if(f>=c&&f<=c+e&&g>=d&&g<=d+b)FiercePlanet.currentNotice=void 0,FiercePlanet.clearCanvas("noticeCanvas")}}};
FiercePlanet.getCurrentPosition=function(a){var b,c;if(a.offsetX||a.offsetX==0)b=a.offsetX,c=a.offsetY;else if(a.layerX||a.layerX==0)b=a.layerX,c=a.layerY;console.log("--------------");console.log(a);console.log(b);console.log(c);b-=FiercePlanet.panLeftOffset;c-=FiercePlanet.panTopOffset;b/=FiercePlanet.zoomLevel;c/=FiercePlanet.zoomLevel;console.log(b);console.log(c);b-=1/FiercePlanet.zoomLevel;c-=1/FiercePlanet.zoomLevel;return{posX:Math.floor(b/FiercePlanet.cellWidth),posY:Math.floor(c/FiercePlanet.cellHeight)}};
FiercePlanet.notify=function(a){$("#notifications")[0].innerHTML=a};FiercePlanet.levelInfo=function(){var a="";FiercePlanet.currentLevel.getName()!=void 0&&(a+="<h3>"+FiercePlanet.currentLevel.getName()+"</h3>");FiercePlanet.currentLevel.getImage()!=void 0&&(a+='<img src="'+FiercePlanet.currentLevel.getImage()+'" alt="City Image" width="460" height="140">');FiercePlanet.currentLevel.getIntroduction()!=void 0&&(a+=FiercePlanet.currentLevel.getIntroduction());FiercePlanet.$newLevel.html(a).dialog("open")};
FiercePlanet.refreshSwatch=function(){for(var a=0;a<FiercePlanet.capabilities.length;a++){var b=$.trim(FiercePlanet.capabilities[a]);try{var c=$("#"+b);c.removeClass("inactive");FiercePlanet.makeResourceActive(c[0])}catch(d){}}};FiercePlanet=FiercePlanet||{};FiercePlanet.loadGame=function(){FiercePlanet.loadSettingsFromStorage();FiercePlanet.setupDialogs();FiercePlanet.initialiseAndLoadResources();FiercePlanet.setupResourceInteraction();FiercePlanet.hookUpUIEventListeners();FiercePlanet.hookUpCustomEventListeners();FiercePlanet.newLevel()};
FiercePlanet.newGame=function(){if(FiercePlanet.currentLevelPreset)FiercePlanet.currentLevelNumber=1;FiercePlanet.currentScore=0;FiercePlanet.previousLevelScore=0;FiercePlanet.gameCounter=0;FiercePlanet.newLevel()};
FiercePlanet.newLevel=function(){FiercePlanet.inDesignMode=!1;FiercePlanet.levelDelayCounter=0;FiercePlanet.levelCounter=0;FiercePlanet.maxLevelMoves=0;FiercePlanet.previousLevelScore=FiercePlanet.currentScore;FiercePlanet.currentLevel!=void 0&&FiercePlanet.currentLevel.setResources([]);FiercePlanet.currentNotice=null;if(FiercePlanet.audio!=void 0)FiercePlanet.audio.pause(),FiercePlanet.audio=void 0;FiercePlanet.recordedLevels=[];FiercePlanet._initialiseGame();FiercePlanet.levelInfo();FiercePlanet.currentNotice=
FiercePlanet.currentLevel.getTip();FiercePlanet.notify("Starting level "+FiercePlanet.currentLevel.getId()+"...")};FiercePlanet.restartLevel=function(){FiercePlanet.currentScore=FiercePlanet.previousLevelScore;FiercePlanet.newLevel()};
FiercePlanet.newWave=function(){FiercePlanet.maxWaveMoves=0;FiercePlanet.waveCounter=0;FiercePlanet.waveDelayCounter=0;FiercePlanet.savedAgentThisWaveCount=0;FiercePlanet.currentLevel.presetAgents(AgentTypes.CITIZEN_AGENT_TYPE,FiercePlanet.numAgents,FiercePlanet.agentsCanCommunicate);FiercePlanet.notify("New wave coming...");FiercePlanet.drawEntryPoints();FiercePlanet.drawExitPoints();FiercePlanet.eventTarget.fire(new Event("game",this,"newWave",$fp.levelCounter,FiercePlanet.currentLevel));FiercePlanet._startAgents()};
FiercePlanet.completeWave=function(){FiercePlanet._finaliseGame();FiercePlanet.currentWave++;FiercePlanet.numAgents++};FiercePlanet.completeLevel=function(){FiercePlanet.currentLevel.isPresetLevel()&&FiercePlanet.currentLevelNumber++;FiercePlanet._finaliseGame();FiercePlanet.showCompleteLevelDialog()};FiercePlanet.gameOver=function(){FiercePlanet.currentScore=FiercePlanet.previousLevelScore;FiercePlanet._finaliseGame();FiercePlanet.showGameOverDialog()};
FiercePlanet.completeGame=function(){FiercePlanet._finaliseGame();FiercePlanet.showCompleteGameDialog()};FiercePlanet.playGame=function(){FiercePlanet.inPlay?FiercePlanet.pauseGame():($("#playAgents").removeClass("pausing"),$("#playAgents").addClass("playing"),FiercePlanet.waveCounter==0?FiercePlanet.newWave():FiercePlanet._startAgents())};FiercePlanet.pauseGame=function(){FiercePlanet.inPlay&&FiercePlanet._stopAgents()};
FiercePlanet.slowDown=function(){FiercePlanet.interval<10?FiercePlanet.interval+=1:FiercePlanet.interval<100&&(FiercePlanet.interval+=10);FiercePlanet.inPlay&&FiercePlanet._startAgents()};FiercePlanet.speedUp=function(){FiercePlanet.interval>10?FiercePlanet.interval-=10:FiercePlanet.interval>1&&(FiercePlanet.interval-=1);FiercePlanet.inPlay&&FiercePlanet._startAgents()};
FiercePlanet._initialiseGame=function(){typeof console!="undefined"&&console.log("Initialising world...");FiercePlanet._stopAgents();if(FiercePlanet.currentLevelNumber<0||FiercePlanet.currentLevelNumber>10)FiercePlanet.currentLevelNumber=1;if(FiercePlanet.currentLevelPreset)try{FiercePlanet.currentLevel=eval("PresetLevels.level"+FiercePlanet.currentLevelNumber.toString())}catch(a){FiercePlanet.currentLevel=eval("PresetLevels.level1")}else if(FiercePlanet.currentLevel==void 0)FiercePlanet.currentLevel=
eval("PresetLevels.level1");if(FiercePlanet.waveOverride>0)FiercePlanet.currentLevel.setWaveNumber(FiercePlanet.waveOverride),FiercePlanet.waveOverride=0;FiercePlanet.resourcesInStore=FiercePlanet.currentLevel.getInitialResourceStore();if(FiercePlanet.resourcesInStore==void 0||FiercePlanet.resourcesInStore==null)FiercePlanet.resourcesInStore=FiercePlanet.STARTING_STORE;FiercePlanet.currentLevel.setCurrentAgents([]);FiercePlanet.currentLevel.setResources([]);if(FiercePlanet.currentLevel.getCatastrophe()!=
void 0)FiercePlanet.currentLevel.getCatastrophe()._struck=!1;FiercePlanet.resourceStatsCount={};for(var b=0;b<FiercePlanet.resourceCategories.length;b++)FiercePlanet.resourceStatsCount[FiercePlanet.resourceCategories[b].getCode()]=0;FiercePlanet.expiredAgentCount=0;FiercePlanet.savedAgentCount=0;FiercePlanet.currentWave=1;FiercePlanet.resourceRecoveryCycle=Math.pow(FiercePlanet.DEFAULT_RESOURCE_RECOVERY,FiercePlanet.levelOfDifficulty-1);FiercePlanet.numAgents=FiercePlanet.currentLevel.getInitialAgentNumber();
FiercePlanet.worldWidth=FiercePlanet.currentLevel.getWorldWidth();FiercePlanet.worldHeight=FiercePlanet.currentLevel.getWorldHeight();FiercePlanet.cellWidth=FiercePlanet.WORLD_WIDTH/FiercePlanet.worldWidth;FiercePlanet.cellHeight=FiercePlanet.WORLD_HEIGHT/FiercePlanet.worldHeight;FiercePlanet.pieceWidth=FiercePlanet.cellWidth*0.5;FiercePlanet.pieceHeight=FiercePlanet.cellHeight*0.5;FiercePlanet.scrollingImage.src="/images/yellow-rain.png";FiercePlanet.currentLevel.setup();FiercePlanet.drawGame()};
FiercePlanet._finaliseGame=function(){FiercePlanet._stopAgents();FiercePlanet.storeData();FiercePlanet.drawScoreboard()};
FiercePlanet._startAgents=function(){typeof console!="undefined"&&console.log("Starting agents...");clearInterval(FiercePlanet.agentTimerId);FiercePlanet.agentTimerId=setInterval("FiercePlanet.processAgents()",FiercePlanet.interval);FiercePlanet.inPlay=!0;$("#playAgents").removeClass("pausing");$("#playAgents").addClass("playing");if(FiercePlanet.soundsPlayable)if(FiercePlanet.audio!=void 0)FiercePlanet.audio.play();else if(FiercePlanet.currentLevel.getSoundSrc()!=void 0)FiercePlanet.audio=new Audio(FiercePlanet.currentLevel.getSoundSrc()),
FiercePlanet.audio.loop=!0,FiercePlanet.audio.addEventListener("ended",function(){FiercePlanet.audio.currentTime=0;FiercePlanet.audio.play()},!1),FiercePlanet.audio.play()};FiercePlanet._stopAgents=function(){typeof console!="undefined"&&console.log("Pausing agents...");$("#playAgents").removeClass("playing");$("#playAgents").addClass("pausing");clearInterval(FiercePlanet.agentTimerId);FiercePlanet.inPlay=!1;FiercePlanet.soundsPlayable&&FiercePlanet.audio!=void 0&&FiercePlanet.audio.pause()};FiercePlanet=FiercePlanet||{};FiercePlanet.PROFILE_ID=null;FiercePlanet.MOVE_HEALTH_COST=-2;FiercePlanet.SAVE_SCORE=10;FiercePlanet.STARTING_STORE=100;FiercePlanet.DEFAULT_RESOURCE_RECOVERY=2;FiercePlanet.WAVE_GOODNESS_BONUS=5;FiercePlanet.NEW_LEVEL_DELAY=3E3;FiercePlanet.NEW_WAVE_DELAY=200;FiercePlanet.EASY_DIFFICULTY=1;FiercePlanet.MEDIUM_DIFFICULTY=2;FiercePlanet.HARD_DIFFICULTY=3;FiercePlanet.EXTREME_DIFFICULTY=4;FiercePlanet.WORLD_WIDTH=480;FiercePlanet.WORLD_HEIGHT=400;
FiercePlanet.WAVE_NOTICE_WIDTH=200;FiercePlanet.WAVE_NOTICE_HEIGHT=150;FiercePlanet.PROFILE_CLASSES=["Novice","Planner","Expert","Visionary","Genius"];FiercePlanet.CAPABILITY_COSTS=[0,100,200,300,500];FiercePlanet.NOVICE_CAPABILITIES=["farm","water","clinic"];FiercePlanet.PLANNER_CAPABILITIES=FiercePlanet.NOVICE_CAPABILITIES.concat(["shop","park","school"]);FiercePlanet.EXPERT_CAPABILITIES=FiercePlanet.PLANNER_CAPABILITIES.concat(["bank","air","legal"]);
FiercePlanet.VISIONARY_CAPABILITIES=FiercePlanet.EXPERT_CAPABILITIES.concat(["factory","energy","democracy"]);FiercePlanet.GENIUS_CAPABILITIES=FiercePlanet.VISIONARY_CAPABILITIES.concat(["stockmarket","biodiversity","festival"]);FiercePlanet.capabilities=["farm","water","clinic"];FiercePlanet.credits=0;FiercePlanet.profileClass="Novice";FiercePlanet.totalSaved=0;FiercePlanet.inDesignMode=!1;FiercePlanet.inPlay=!1;FiercePlanet.isMouseDown=!1;FiercePlanet.isMouseMoving=!1;
FiercePlanet.scrollingImageVisible=!0;FiercePlanet.noticesVisible=!0;FiercePlanet.agentsCanCommunicate=!0;FiercePlanet.catastrophesVisible=!0;FiercePlanet.disableKeyboardShortcuts=!1;FiercePlanet.soundsPlayable=!1;FiercePlanet.recording=!1;FiercePlanet.invisiblePath=!1;FiercePlanet.agentTracing=!1;FiercePlanet.resourcesUpgradeable=!1;FiercePlanet.resourcesInTension=!1;FiercePlanet.resourceBonus=!1;FiercePlanet.applyGeneralHealth=!1;FiercePlanet.ignoreResourceBalance=!1;FiercePlanet.godMode=!1;
FiercePlanet.predatorsVisible=!1;FiercePlanet.rivalsVisible=!1;FiercePlanet.tilesMutable=!1;FiercePlanet.tilesRemovable=!1;FiercePlanet.backgroundIconsVisible=!1;FiercePlanet.resourceTypeNamespace=TBL;FiercePlanet.resourceCategories=[];FiercePlanet.resourceTypes=[];FiercePlanet.agentTimerId=0;FiercePlanet.eventTarget=new EventTarget;FiercePlanet.recordedLevels=[];FiercePlanet.currentLevelNumber=1;FiercePlanet.currentWave=1;FiercePlanet.currentLevelPreset=!0;FiercePlanet.currentLevel=null;
FiercePlanet.existingCurrentLevel=null;FiercePlanet.currentResourceId=null;FiercePlanet.currentResource=null;FiercePlanet.currentNotice=null;FiercePlanet.waveOverride=0;FiercePlanet.maxWaveMoves=0;FiercePlanet.maxLevelMoves=0;FiercePlanet.levelOfDifficulty=FiercePlanet.MEDIUM_DIFFICULTY;FiercePlanet.resourceRecoveryCycle=5;FiercePlanet.interval=20;FiercePlanet.levelDelayCounter=0;FiercePlanet.waveDelayCounter=0;FiercePlanet.numAgents=1;FiercePlanet.resourceStatsCount={};FiercePlanet.waveCounter=0;
FiercePlanet.levelCounter=0;FiercePlanet.gameCounter=0;FiercePlanet.globalRecordingCounter=0;FiercePlanet.previousLevelScore=0;FiercePlanet.currentScore=0;FiercePlanet.resourcesInStore=0;FiercePlanet.resourcesSpent=0;FiercePlanet.expiredAgentCount=0;FiercePlanet.savedAgentCount=0;FiercePlanet.savedAgentThisWaveCount=0;FiercePlanet.zoomLevel=1;FiercePlanet.externalZoomLevel=1;FiercePlanet.panLeftOffset=0;FiercePlanet.panTopOffset=0;FiercePlanet.worldWidth=14;FiercePlanet.worldHeight=11;
FiercePlanet.cellWidth=FiercePlanet.WORLD_WIDTH/FiercePlanet.worldWidth;FiercePlanet.cellHeight=FiercePlanet.WORLD_HEIGHT/FiercePlanet.worldHeight;FiercePlanet.pieceWidth=FiercePlanet.cellWidth*0.5;FiercePlanet.pieceHeight=FiercePlanet.cellHeight*0.5;FiercePlanet.scrollingImage=new Image;FiercePlanet.scrollingImageX=0;FiercePlanet.scrollingImageOffset=1;FiercePlanet.audio=null;FiercePlanet.googleMap=null;FiercePlanet.currentX=null;FiercePlanet.currentY=null;FiercePlanet.$gameOver=null;
FiercePlanet.$completeLevel=null;FiercePlanet.$completeGame=null;FiercePlanet.$levelList=null;FiercePlanet.$upgradeDelete=null;FiercePlanet.$resourceGallery=null;FiercePlanet.$newLevel=null;FiercePlanet.$settingsDialog=null;FiercePlanet.$genericDialog=null;FiercePlanet.$designFeatures=null;FiercePlanet.$editProperties=null;FiercePlanet=FiercePlanet||{};FiercePlanet.loadSettingsFromStorage=function(){FiercePlanet.currentLevelNumber=localStorage.currentLevelNumber!=void 0?parseInt(localStorage.currentLevelNumber):FiercePlanet.currentLevelNumber;FiercePlanet.currentLevelPreset=localStorage.currentLevelPreset!=void 0?localStorage.currentLevelPreset==="true":FiercePlanet.currentLevelPreset;FiercePlanet.currentScore=localStorage.currentScore!=void 0?parseInt(localStorage.currentScore):FiercePlanet.currentScore};
FiercePlanet.storeData=function(){localStorage.currentScore=FiercePlanet.previousLevelScore;localStorage.currentLevelNumber=FiercePlanet.currentLevelNumber;localStorage.currentLevelPreset=FiercePlanet.currentLevel.isPresetLevel();localStorage.totalSaved=FiercePlanet.totalSaved;localStorage.profileClass=FiercePlanet.profileClass;localStorage.credits=FiercePlanet.credits;localStorage.capabilities=FiercePlanet.capabilities;if(localStorage.highestScore==void 0||FiercePlanet.currentScore>localStorage.highestScore)localStorage.highestScore=
FiercePlanet.currentScore;if(localStorage.highestLevel==void 0||FiercePlanet.currentLevelNumber>localStorage.highestLevel)localStorage.highestLevel=FiercePlanet.currentLevelNumber};
FiercePlanet.determineCreditsAndClass=function(){FiercePlanet.credits+=FiercePlanet.resourcesInStore;FiercePlanet.totalSaved+=FiercePlanet.savedAgentCount;if(FiercePlanet.totalSaved>5E3)FiercePlanet.profileClass="Genius";else if(FiercePlanet.totalSaved>2500)FiercePlanet.profileClass="Visionary";else if(FiercePlanet.totalSaved>1E3)FiercePlanet.profileClass="Expert";else if(FiercePlanet.totalSaved>500)FiercePlanet.profileClass="Planner"};
FiercePlanet.compileStats=function(){var a=FiercePlanet.currentLevel.getResources().length;return{"profile[current_level]":FiercePlanet.currentLevelNumber,"profile[current_score]":FiercePlanet.currentScore,"profile[profile_class]":FiercePlanet.profileClass,"profile[credits]":FiercePlanet.credits,"profile[capabilities]":FiercePlanet.capabilities.join(","),waves_survived:FiercePlanet.currentWave,saved_agent_count:FiercePlanet.savedAgentCount,expired_agent_count:FiercePlanet.expiredAgentCount,resources_spent:FiercePlanet.resourcesSpent,
resources_in_store:FiercePlanet.resourcesInStore,resources:a,progress_towards_next_class:0}};
FiercePlanet.generateStats=function(){return"<table><tr><td>Score:</td><td>"+FiercePlanet.currentScore+"</td></tr><tr><td>Level:</td><td>"+FiercePlanet.currentLevel.getId()+"</td></tr><tr><td>Waves survived:</td><td>"+FiercePlanet.currentWave+"</td></tr><tr><td>Citizens saved:</td><td>"+FiercePlanet.savedAgentCount+"</td></tr><tr><td>Citizens expired:</td><td>"+FiercePlanet.expiredAgentCount+"</td></tr><tr><td>Resources spent:</td><td>"+FiercePlanet.resourcesSpent+"</td></tr><tr><td>Resources remaining:</td><td>"+
FiercePlanet.resourcesInStore+"</td></tr><tr><td></td><td></td></tr><tr><td>Total saved:</td><td>"+FiercePlanet.totalSaved+"</td></tr><tr><td>Profile class:</td><td>"+FiercePlanet.profileClass+"</td></tr><tr><td>Credits:</td><td><span style='font-weight:bold'>"+FiercePlanet.credits+" [<a href='#' id='gotoResourceGallery'>SPEND</a></span></td></tr></table>"};FiercePlanet.updateStats=function(a){var b=FiercePlanet.compileStats();$.post("/profiles/"+FiercePlanet.PROFILE_ID+"/update_stats",b,a)};
FiercePlanet.saveCapabilities=function(){FiercePlanet.PROFILE_ID!=void 0&&FiercePlanet.updateStats(function(){})};FiercePlanet=FiercePlanet||{};
FiercePlanet.recordWorld=function(){if(FiercePlanet.currentLevel!=void 0){typeof console!="undefined"&&console.log("Recording at: "+FiercePlanet.globalRecordingCounter);try{for(var a=new Level(FiercePlanet.currentLevel._id),b=[],c=0,d=FiercePlanet.currentLevel.getCurrentAgents().length;c<d;c++){var e=FiercePlanet.currentLevel.getCurrentAgents()[c],f=new Agent(e.getType(),e.getX(),e.getY());f.setLastMemory(e.getLastMemory());f.setDelay(e.getDelay());f.setSpeed(e.getSpeed());b.push(f)}a.setCurrentAgents(b);
a.setResources(FiercePlanet.currentLevel.getResources());FiercePlanet.recordedLevels[FiercePlanet.globalRecordingCounter]=$.toJSON(a);FiercePlanet.globalRecordingCounter++}catch(g){}}};
FiercePlanet.replayWorld=function(){FiercePlanet._stopAgents();FiercePlanet.existingCurrentLevel=FiercePlanet.currentLevel;clearInterval(FiercePlanet.agentTimerId);FiercePlanet.globalRecordingCounter=0;FiercePlanet.waveCounter=0;FiercePlanet.drawGame();FiercePlanet.inPlay=!0;setTimeout("FiercePlanet.replayStart()",100)};FiercePlanet.replayStart=function(){FiercePlanet.agentTimerId=setInterval("FiercePlanet.replayStep()",FiercePlanet.interval*2)};
FiercePlanet.replayStep=function(){var a=FiercePlanet.recordedLevels[FiercePlanet.globalRecordingCounter];typeof console!="undefined"&&console.log("Replaying at: "+FiercePlanet.globalRecordingCounter);if(a==void 0)FiercePlanet.replayStop();else try{FiercePlanet.clearAgents(),FiercePlanet.currentLevel=$.evalJSON(a),FiercePlanet.globalRecordingCounter++,FiercePlanet.waveCounter++,FiercePlanet.clearCanvas("resourceCanvas"),FiercePlanet.clearCanvas("scrollingCanvas"),FiercePlanet.clearCanvas("noticeCanvas"),
FiercePlanet.clearCanvas("agentCanvas"),FiercePlanet.drawEntryPoints(),FiercePlanet.drawExitPoints(),FiercePlanet.drawResources(),FiercePlanet.drawScrollingLayer(),FiercePlanet.drawAgents()}catch(b){}};FiercePlanet.replayStop=function(){FiercePlanet.agentTimerId=clearInterval(FiercePlanet.agentTimerId);FiercePlanet.globalRecordingCounter=0;FiercePlanet.currentLevel=FiercePlanet.existingCurrentLevel;FiercePlanet.inPlay=!1};FiercePlanet=FiercePlanet||{};
FiercePlanet.setupResourceInteraction=function(){for(var a=$(".swatch-instance"),b=null,c=0;c<a.length;c++)b=a[c],b.id&&$.inArray(b.id,FiercePlanet.capabilities)!=-1&&FiercePlanet.makeResourceActive(b);a=$("#agentCanvas")[0];a.addEventListener("click",function(a){a.preventDefault&&a.preventDefault();FiercePlanet.inDesignMode||FiercePlanet.showUpgradeDeleteDialog(a);return!1},!1);a.addEventListener("dragstart",function(a){a.preventDefault&&a.preventDefault();this.className="over";a.dataTransfer.dropEffect=
"copy";return!1},!1);a.addEventListener("dragover",function(a){a.preventDefault&&a.preventDefault();this.className="over";a.dataTransfer.dropEffect="copy";return!1},!1);a.addEventListener("dragenter",function(){this.className="over";return!1},!1);a.addEventListener("dragleave",function(){this.className=""},!1);a.addEventListener("drop",function(a){a.stopPropagation&&a.stopPropagation();this.className="";FiercePlanet.dropItem(a)},!1)};
FiercePlanet.makeResourceActive=function(a){a.setAttribute("draggable","true");a.addEventListener("dragstart",function(a){a.dataTransfer.effectAllowed="copy";a.dataTransfer.setData("Text",this.id);FiercePlanet.currentResourceId=this.id},!1);a.addEventListener("click",function(){FiercePlanet.currentResourceId=this.id},!1)};
FiercePlanet.deleteCurrentResource=function(){var a=FiercePlanet.getCurrentResourceIndex();a>-1&&(FiercePlanet.resourcesInStore+=5,FiercePlanet.resourcesSpent-=5,FiercePlanet.currentLevel.getResources().splice(a,1),FiercePlanet.drawResourcesInStore(),FiercePlanet.clearCanvas("resourceCanvas"),FiercePlanet.drawResources())};
FiercePlanet.upgradeCurrentResource=function(){if(FiercePlanet.getCurrentResourceIndex()>-1){var a=FiercePlanet.currentLevel.getResources()[i];a.getUpgradeLevel()<=4&&FiercePlanet.resourcesInStore>=a.getUpgradeCost()&&(FiercePlanet.resourcesInStore-=a.getUpgradeCost(),FiercePlanet.resourcesSpent+=a.getUpgradeCost(),a.setUpgradeLevel(a.getUpgradeLevel()+1),FiercePlanet.drawResource(a),FiercePlanet.drawResourcesInStore())}};
FiercePlanet.dropItem=function(a){var b=FiercePlanet.getCurrentPosition(a),c=b.posX,b=b.posY;if((FiercePlanet.currentLevel.getCell(c,b)!=void 0||FiercePlanet.currentLevel.getAllowResourcesOnPath())&&!FiercePlanet.isPositionOccupiedByResource(c,b)){var d=FiercePlanet.currentResourceId;a.dataTransfer&&(d=a.dataTransfer.getData("Text"));a=FiercePlanet.resolveResourceKind(d);c=new Resource(a,c,b);FiercePlanet.resourcesInStore<c.getCost()?FiercePlanet.notify("Not enough goodness for now - save some more agents!"):
(FiercePlanet.resourcesInStore-=c.getCost(),FiercePlanet.resourcesSpent+=c.getCost(),a=c.getCategory().getCode(),FiercePlanet.resourceStatsCount[a]+=1,FiercePlanet.currentLevel.getResources().push(c),FiercePlanet.drawResource(c),FiercePlanet.drawResourcesInStore(),FiercePlanet.eventTarget.fire(new Event("resource",c,"added",FiercePlanet.gameCounter,FiercePlanet.currentLevel)))}};
FiercePlanet.getCurrentResourceIndex=function(){for(var a=0;a<FiercePlanet.currentLevel.getResources().length;a++)if(FiercePlanet.currentLevel.getResources()[a]==FiercePlanet.currentResource)return a;return-1};FiercePlanet.isPositionOccupiedByResource=function(a,b){for(var c=0;c<FiercePlanet.currentLevel.getResources().length;c++){var d=FiercePlanet.currentLevel.getResources()[c];if(d.getPosition()[0]==a&&d.getPosition()[1]==b)return!0}return!1};
FiercePlanet.calculateResourceEffect=function(a){if(FiercePlanet.ignoreResourceBalance||FiercePlanet.applyGeneralHealth)return 1;var b=a.getCategory().getCode(),c=0,d=FiercePlanet.currentLevel.getResources().length;if(d==1)return 1;c=FiercePlanet.resourceStatsCount[b];b=c/d*d;d=b<=1?b:(d-b)/(d-1);d*=d;FiercePlanet.resourcesInTension&&(d*=FiercePlanet.calculateSurroundingResourcesEffects(a));return d};
FiercePlanet.calculateSurroundingResourcesEffects=function(a){for(var b=a.getX(),c=a.getY(),a=a.getCategory(),d=1,e=0;e<FiercePlanet.currentLevel.getResources().length;e++){var f=FiercePlanet.currentLevel.getResources()[e],g=f.getX(),h=f.getY(),f=f.getCategory();if((b!=g||h!=c)&&Math.abs(g-b)<=1&&Math.abs(h-c)<=1)d*=a.doEvaluateOtherCategoryImpact(f)}return d};
FiercePlanet.recoverResources=function(){for(var a=0;a<FiercePlanet.currentLevel.getResources().length;a++){var b=FiercePlanet.currentLevel.getResources()[a];b.getTotalYield()<b.getInitialTotalYield()&&(b.setTotalYield(b.getTotalYield()+1),FiercePlanet.drawResource(b))}};FiercePlanet.resetResourceYields=function(){for(var a=0;a<FiercePlanet.currentLevel.getResources().length;a++){var b=FiercePlanet.currentLevel.getResources()[a];b.setTotalYield(b.getInitialTotalYield())}};
FiercePlanet.resolveResourceKind=function(a){for(var b=0;b<FiercePlanet.resourceTypes.length;b++){var c=FiercePlanet.resourceTypes[b];if(c._code==a)return c}return null};FiercePlanet.registerResourceCategories=function(a){FiercePlanet.resourceCategories=a};FiercePlanet.registerResourceTypes=function(a){FiercePlanet.resourceTypes=a};
FiercePlanet.initialiseAndLoadResources=function(){FiercePlanet.resourceTypeNamespace.doSetup&&FiercePlanet.resourceTypeNamespace.doSetup();for(var a=0;a<FiercePlanet.resourceCategories.length;a++){var b=FiercePlanet.resourceCategories[a],c='<div class="swatch-category" id="'+b.getCode()+'"></div>';$("#swatch").append(c);var c=$("#"+b.getCode()),d='<div class="title">'+b.getName()+"</div>";c.append(d);c.css("background","#"+b.getColor());d='<div class="gallery-category" id="gallery-'+b.getCode()+
'"></div>';$("#gallery-items").append(d);var d=$("#gallery-"+b.getCode()),e='<div class="title">'+b.getName()+"</div>";d.append(e);for(var f=e=0;f<FiercePlanet.resourceTypes.length;f++){var g=FiercePlanet.resourceTypes[f];if(g.getCategory()==b){var h='<div class="swatch-instance" id="'+g.getCode()+'" title="'+g.getName()+'"><a href="#"><img src="'+g.getImage()+'" alt=""></a></div>';c.append(h);h=$("#"+g.getCode());e>0&&h.addClass("inactive");g='<div class="swatch-instance purchase inactive" id="'+
g.getCode()+'-purchase" title="'+g.getName()+'"><a href="#"><img src="'+g.getImage()+'" alt=""></a></div>';d.append(g);e++}}}};FiercePlanet=FiercePlanet||{};$(document).ajaxSend(function(a,b,c){if(c.type=="post")c.data=(c.data?c.data+"&":"")+"authenticity_token="+encodeURIComponent(AUTH_TOKEN)});$(function(){$().zoom(function(a){console.log("zooming");switch(a){case 1:FiercePlanet.externalZoomLevel*=1.2;break;case -1:FiercePlanet.externalZoomLevel/=1.2;break;case 0:FiercePlanet.externalZoomLevel=1}})});FiercePlanet.checkInteger=function(a){return Math.floor(a)};
FiercePlanet.getAndRetrieveProperty=function(a){if($("#"+a+"Input")[0]!=void 0&&localStorage[a]=="true")this[a]=!0,$("#"+a+"Input")[0].checked=!0};FiercePlanet.setAndStoreProperty=function(a){if($("#"+a+"Input")[0]!=void 0){var b=$("#"+a+"Input")[0].checked;this[a]=b;localStorage[a]=b}};
FiercePlanet.getAndRetrieveProperties=function(){FiercePlanet.getAndRetrieveProperty("noticesVisible");FiercePlanet.getAndRetrieveProperty("scrollingImageVisible");FiercePlanet.getAndRetrieveProperty("catastrophesVisible");FiercePlanet.getAndRetrieveProperty("soundsPlayable");FiercePlanet.getAndRetrieveProperty("disableKeyboardShortcuts");FiercePlanet.getAndRetrieveProperty("agentsCanCommunicate");FiercePlanet.getAndRetrieveProperty("recording");FiercePlanet.getAndRetrieveProperty("invisiblePath");
FiercePlanet.getAndRetrieveProperty("agentTracing");FiercePlanet.getAndRetrieveProperty("resourcesUpgradeable");FiercePlanet.getAndRetrieveProperty("resourcesInTension");FiercePlanet.getAndRetrieveProperty("resourceBonus");FiercePlanet.getAndRetrieveProperty("applyGeneralHealth");FiercePlanet.getAndRetrieveProperty("ignoreResourceBalance");FiercePlanet.getAndRetrieveProperty("godMode");FiercePlanet.getAndRetrieveProperty("rivalsVisible");FiercePlanet.getAndRetrieveProperty("predatorsVisible");FiercePlanet.getAndRetrieveProperty("tilesMutable");
FiercePlanet.getAndRetrieveProperty("tilesRemovable");FiercePlanet.getAndRetrieveProperty("backgroundIconsVisible")};
FiercePlanet.setAndStoreProperties=function(){FiercePlanet.setAndStoreProperty("noticesVisible");FiercePlanet.setAndStoreProperty("scrollingImageVisible");FiercePlanet.setAndStoreProperty("catastrophesVisible");FiercePlanet.setAndStoreProperty("soundsPlayable");FiercePlanet.setAndStoreProperty("disableKeyboardShortcuts");FiercePlanet.setAndStoreProperty("agentsCanCommunicate");FiercePlanet.setAndStoreProperty("recording");FiercePlanet.setAndStoreProperty("invisiblePath");FiercePlanet.setAndStoreProperty("agentTracing");
FiercePlanet.setAndStoreProperty("resourcesUpgradeable");FiercePlanet.setAndStoreProperty("resourcesInTension");FiercePlanet.setAndStoreProperty("resourceBonus");FiercePlanet.setAndStoreProperty("applyGeneralHealth");FiercePlanet.setAndStoreProperty("ignoreResourceBalance");FiercePlanet.setAndStoreProperty("godMode");FiercePlanet.setAndStoreProperty("rivalsVisible");FiercePlanet.setAndStoreProperty("predatorsVisible");FiercePlanet.setAndStoreProperty("tilesMutable");FiercePlanet.setAndStoreProperty("tilesRemovable");
FiercePlanet.setAndStoreProperty("backgroundIconsVisible");FiercePlanet.disableKeyboardShortcuts?$(document).unbind("keydown"):$(document).keydown(FiercePlanet.handleKeyboardShortcuts);FiercePlanet.resourcesUpgradeable?$("#upgrade-option").css("display","block"):$("#upgrade-option").css("display","none");FiercePlanet.restartLevel()};FiercePlanet.zeroFill=function(a,b){b-=a.toString().length;if(b>0)return Array(b+(/\./.test(a)?2:1)).join("0")+a;return a};var AgentTypes=function(){};AgentTypes.CITIZEN_AGENT_TYPE=new AgentType("Citizen","000");
AgentTypes.CITIZEN_AGENT_TYPE.setDrawFunction(function(a,b,c,d,e,f,g,h,j){e<8||f<8?(b=e/4,a.lineWidth=2,a.beginPath(),a.arc(c+b,d+b,b,0,Math.PI*2,!1),a.closePath(),a.strokeStyle="#ccc"):(b=e/4,a.lineWidth=1,a.beginPath(),a.arc(c,d,b,0,Math.PI*2,!1),a.closePath(),a.strokeStyle="#ccc",a.stroke(),a.fillStyle="#"+g,a.fill(),e/=2,a.beginPath(),a.moveTo(c,d-b+6),a.lineTo(c-1,d-b+6+e),h%2==1?(h=j==0?-1:1,j=j==0?-4:4,a.moveTo(c+4,d+8+2*h),a.lineTo(c-4,d+8-2*h),a.moveTo(c,d-b+6+e),a.lineTo(c+h+j,d-b+6+e+Math.abs(j)),
a.moveTo(c,d-b+5+e),a.lineTo(c-h-j/2,d-b+6+e),a.moveTo(c-h-j/2,d-b+6+e),a.lineTo(c-h-j/2,d-b+6+e+Math.abs(j)/2)):(h=j==0?1:-1,j=j==0?4:-4,a.moveTo(c+4,d+8+2*h),a.lineTo(c-4,d+8-2*h),a.moveTo(c,d-b+6+e),a.lineTo(c+j,d-b+6+e+Math.abs(j)),a.moveTo(c,d-b+6+e),a.lineTo(c-j/2,d-b+6+e+Math.abs(j)/2),a.moveTo(c-j/2,d-b+6+e+Math.abs(j)/2),a.lineTo(c-j,d-b+6+e)),a.closePath(),a.strokeStyle="#"+g);a.stroke();a.fillStyle="#"+g;a.fill()});AgentTypes.PREDATOR_AGENT_TYPE=new AgentType("Predator","fbe53b");
AgentTypes.PREDATOR_AGENT_TYPE.setDrawFunction(function(a,b,c,d,e,f,g,h){b=new Image;b.src=h%4==0?"/images/agents/monster1.png":h%4==1?"/images/agents/monster2.png":h%4==2?"/images/agents/monster1.png":"/images/agents/monster3.png";a.drawImage(b,c-e/2,d-e/2,e,e)});AgentTypes.RIVAL_AGENT_TYPE=new AgentType("Rival","3be5fb");
AgentTypes.RIVAL_AGENT_TYPE.setDrawFunction(function(a,b,c,d,e,f,g,h){b=e/4;e/=2;a.beginPath();a.arc(c,d,b,0,Math.PI*2,!1);a.closePath();a.strokeStyle="#ccc";a.stroke();a.fillStyle="#"+g;a.fill();a.beginPath();a.moveTo(c,d+b);a.lineTo(c,d+b+e/2);h%2==0?(h=Math.sin(30*Math.PI/180)*e/2,f=Math.cos(30*Math.PI/180)*e/2,a.moveTo(c,d+b+e/2),a.lineTo(c-h,d+b+e/2+f),a.moveTo(c,d+b+e/2),a.lineTo(c+h,d+b+e/2+f),a.moveTo(c-e/2,d+b+e/6),a.lineTo(c+e/2,d+b+e/6)):(a.moveTo(c,d+b+e/2),a.lineTo(c,d+b+e),h=Math.sin(45*
Math.PI/180)*e/2,f=Math.cos(45*Math.PI/180)*e/2,a.moveTo(c-h,d+b+e/6+f),a.lineTo(c,d+b+e/6),a.moveTo(c+h,d+b+e/6+f),a.lineTo(c,d+b+e/6));a.closePath();a.strokeStyle="#"+g;a.lineWidth=2;a.stroke()});FiercePlanet=FiercePlanet||{};FiercePlanet.novice=new PlayerClass("Novice",0);FiercePlanet.teamLeader=new PlayerClass("Team Leader",200);FiercePlanet.planner=new PlayerClass("Planner",500);var FiercePlanet=FiercePlanet||{},TBL=TBL||{};TBL.ECO_CATEGORY=new ResourceCategory("Economic","eco","44ABE0");TBL.ENV_CATEGORY=new ResourceCategory("Environmental","env","CBDB2A");TBL.SOC_CATEGORY=new ResourceCategory("Social","soc","DE1F2A");TBL.ECO_CATEGORY.setEvaluateOtherCategoryImpact(function(a){var a=a.getCode(),b=1;a=="eco"?b*=1.2:a=="env"?b*=1:a=="soc"&&(b*=0.8);return b});
TBL.ENV_CATEGORY.setEvaluateOtherCategoryImpact(function(a){var a=a.getCode(),b=1;a=="eco"?b*=0.25:a=="env"?b*=1.2:a=="soc"&&(b*=1);return b});TBL.SOC_CATEGORY.setEvaluateOtherCategoryImpact(function(a){var a=a.getCode(),b=1;a=="eco"?b*=0.5:a=="env"?b*=1.1:a=="soc"&&(b*=1.2);return b});TBL.FARM_RESOURCE_TYPE=new ResourceType(TBL.ECO_CATEGORY,"Farm","farm","/images/farm.gif",10,20,100,20);TBL.SHOP_RESOURCE_TYPE=new ResourceType(TBL.ECO_CATEGORY,"Shop","shop","/images/shop.gif",15,25,100,30);
TBL.BANK_RESOURCE_TYPE=new ResourceType(TBL.ECO_CATEGORY,"Bank","bank","/images/bank.gif",20,30,100,50);TBL.FACTORY_RESOURCE_TYPE=new ResourceType(TBL.ECO_CATEGORY,"Factory","factory","/images/factory.gif",25,40,100,70);TBL.STOCKMARKET_RESOURCE_TYPE=new ResourceType(TBL.ECO_CATEGORY,"Stockmarket","stockmarket","/images/stockmarket.gif",30,50,100,90);TBL.FRESH_WATER_RESOURCE_TYPE=new ResourceType(TBL.ENV_CATEGORY,"Fresh Water","water","/images/water.gif",10,20,100,10);
TBL.WILDLIFE_PARK_RESOURCE_TYPE=new ResourceType(TBL.ENV_CATEGORY,"Wildlife Park","park","/images/park.gif",15,25,100,15);TBL.CLEAN_AIR_RESOURCE_TYPE=new ResourceType(TBL.ENV_CATEGORY,"Clear Air","air","/images/air.gif",20,30,100,25);TBL.GREEN_ENERGY_RESOURCE_TYPE=new ResourceType(TBL.ENV_CATEGORY,"Green Energy","energy","/images/energy.gif",25,40,100,35);TBL.BIODIVERSITY_RESOURCE_TYPE=new ResourceType(TBL.ENV_CATEGORY,"Biodiversity","biodiversity","/images/biodiversity.gif",30,50,100,45);
TBL.CLINIC_RESOURCE_TYPE=new ResourceType(TBL.SOC_CATEGORY,"Clinic","clinic","/images/clinic.gif",10,20,100,5);TBL.SCHOOL_RESOURCE_TYPE=new ResourceType(TBL.SOC_CATEGORY,"School","school","/images/school.gif",15,25,100,8);TBL.LEGAL_SYSTEM_RESOURCE_TYPE=new ResourceType(TBL.SOC_CATEGORY,"Legal System","legal","/images/legal.gif",20,30,100,15);TBL.DEMOCRACY_RESOURCE_TYPE=new ResourceType(TBL.SOC_CATEGORY,"Democracy","democracy","/images/democracy.gif",25,40,100,20);
TBL.FESTIVAL_RESOURCE_TYPE=new ResourceType(TBL.SOC_CATEGORY,"Festival","festival","/images/festival.gif",30,50,100,25);TBL.ECONOMIC_RESOURCE_TYPES=[TBL.FARM_RESOURCE_TYPE,TBL.SHOP_RESOURCE_TYPE,TBL.BANK_RESOURCE_TYPE,TBL.FACTORY_RESOURCE_TYPE,TBL.STOCKMARKET_RESOURCE_TYPE];TBL.ENVIRONMENTAL_RESOURCE_TYPES=[TBL.FRESH_WATER_RESOURCE_TYPE,TBL.WILDLIFE_PARK_RESOURCE_TYPE,TBL.CLEAN_AIR_RESOURCE_TYPE,TBL.GREEN_ENERGY_RESOURCE_TYPE,TBL.BIODIVERSITY_RESOURCE_TYPE];
TBL.SOCIAL_RESOURCE_TYPES=[TBL.CLINIC_RESOURCE_TYPE,TBL.SCHOOL_RESOURCE_TYPE,TBL.LEGAL_SYSTEM_RESOURCE_TYPE,TBL.DEMOCRACY_RESOURCE_TYPE,TBL.FESTIVAL_RESOURCE_TYPE];TBL.doSetup=function(){FiercePlanet.registerResourceCategories([TBL.ECO_CATEGORY,TBL.ENV_CATEGORY,TBL.SOC_CATEGORY]);FiercePlanet.registerResourceTypes(TBL.ECONOMIC_RESOURCE_TYPES.concat(TBL.ENVIRONMENTAL_RESOURCE_TYPES.concat(TBL.SOCIAL_RESOURCE_TYPES)))};var FiercePlanet=FiercePlanet||{},CoS=CoS||{};CoS.ECO_CATEGORY=new ResourceCategory("Economy","eco","44ABE0");CoS.ENV_CATEGORY=new ResourceCategory("Ecology","enl","CBDB2A");CoS.POL_CATEGORY=new ResourceCategory("Political","pol","DE1F2A");CoS.CUL_CATEGORY=new ResourceCategory("Cultural","cul","2ADBCB");CoS.FARM_RESOURCE_TYPE=new ResourceType(CoS.ECO_CATEGORY,"Farm","farm","/images/farm.gif",10,20,100,20);
CoS.SHOP_RESOURCE_TYPE=new ResourceType(CoS.ECO_CATEGORY,"Shop","shop","/images/shop.gif",15,25,100,30);CoS.BANK_RESOURCE_TYPE=new ResourceType(CoS.ECO_CATEGORY,"Bank","bank","/images/bank.gif",20,30,100,50);CoS.FACTORY_RESOURCE_TYPE=new ResourceType(CoS.ECO_CATEGORY,"Factory","factory","/images/factory.gif",25,40,100,70);CoS.STOCKMARKET_RESOURCE_TYPE=new ResourceType(CoS.ECO_CATEGORY,"Stockmarket","stockmarket","/images/stockmarket.gif",30,50,100,90);
CoS.FRESH_WATER_RESOURCE_TYPE=new ResourceType(CoS.ENV_CATEGORY,"Fresh Water","water","/images/water.gif",10,20,100,10);CoS.WILDLIFE_PARK_RESOURCE_TYPE=new ResourceType(CoS.ENV_CATEGORY,"Wildlife Park","park","/images/park.gif",15,25,100,15);CoS.CLEAN_AIR_RESOURCE_TYPE=new ResourceType(CoS.ENV_CATEGORY,"Clear Air","air","/images/air.gif",20,30,100,25);CoS.GREEN_ENERGY_RESOURCE_TYPE=new ResourceType(CoS.ENV_CATEGORY,"Green Energy","energy","/images/energy.gif",25,40,100,35);
CoS.BIODIVERSITY_RESOURCE_TYPE=new ResourceType(CoS.ENV_CATEGORY,"Biodiversity","biodiversity","/images/biodiversity.gif",30,50,100,45);CoS.LEGAL_SYSTEM_RESOURCE_TYPE=new ResourceType(CoS.POL_CATEGORY,"Legal System","legal","/images/legal.gif",20,30,100,15);CoS.DEMOCRACY_RESOURCE_TYPE=new ResourceType(CoS.POL_CATEGORY,"Democracy","democracy","/images/democracy.gif",25,40,100,20);CoS.CLINIC_RESOURCE_TYPE=new ResourceType(CoS.CUL_CATEGORY,"Clinic","clinic","/images/clinic.gif",10,20,100,5);
CoS.SCHOOL_RESOURCE_TYPE=new ResourceType(CoS.CUL_CATEGORY,"School","school","/images/school.gif",15,25,100,8);CoS.FESTIVAL_RESOURCE_TYPE=new ResourceType(CoS.CUL_CATEGORY,"Festival","festival","/images/festival.gif",30,50,100,25);CoS.ECONOMIC_RESOURCE_TYPES=[CoS.FARM_RESOURCE_TYPE,CoS.SHOP_RESOURCE_TYPE,CoS.BANK_RESOURCE_TYPE,CoS.FACTORY_RESOURCE_TYPE,CoS.STOCKMARKET_RESOURCE_TYPE];
CoS.ECOLOGICAL_RESOURCE_TYPES=[CoS.FRESH_WATER_RESOURCE_TYPE,CoS.WILDLIFE_PARK_RESOURCE_TYPE,CoS.CLEAN_AIR_RESOURCE_TYPE,CoS.GREEN_ENERGY_RESOURCE_TYPE,CoS.BIODIVERSITY_RESOURCE_TYPE];CoS.POLITICAL_RESOURCE_TYPES=[CoS.LEGAL_SYSTEM_RESOURCE_TYPE,CoS.DEMOCRACY_RESOURCE_TYPE];CoS.CULTURAL_RESOURCE_TYPES=[CoS.CLINIC_RESOURCE_TYPE,CoS.SCHOOL_RESOURCE_TYPE,CoS.FESTIVAL_RESOURCE_TYPE];
CoS.doSetup=function(){FiercePlanet.registerResourceCategories([CoS.ECO_CATEGORY,CoS.ENV_CATEGORY,CoS.POL_CATEGORY,CoS.CUL_CATEGORY]);FiercePlanet.registerResourceTypes(CoS.ECONOMIC_RESOURCE_TYPES.concat(CoS.ECOLOGICAL_RESOURCE_TYPES.concat(CoS.POLITICAL_RESOURCE_TYPES.concat(CoS.CULTURAL_RESOURCE_TYPES))));FiercePlanet.capabilities=["farm","water","clinic","legal"]};var PresetLevels=function(){};PresetLevels.MAX_DEFAULT_LEVELS=10;PresetLevels.level0=new Level(0);PresetLevels.level0.setPresetLevel(!0);PresetLevels.level0.addEntryPoint(0,0);PresetLevels.level0.addExitPoint(4,4);PresetLevels.level0.setWorldWidth(5);PresetLevels.level0.setWorldHeight(5);PresetLevels.level0.setInitialAgentNumber(1);PresetLevels.level0.setWaveNumber(3);PresetLevels.level0.setExpiryLimit(20);PresetLevels.level0.setName("Tutorial");PresetLevels.level0.setIntroduction("<p>The aim of Fierce Planet is to help citizens survive as they move towards their goal (marked by a yellow circle).</p> <p>You do this by placing <em>resources</em> on squares around their path. You can click or drag resources anywhere on the game map.</p> <p>Resources come in three kinds: economic, environmental and social. Your citizens need all of these. If you don't provide enough resources of a particular kind, your citizens will turn that colour. You need to place some resources of that kind nearby.</p> <p>You start with a limited amount of resources. Saving citizens will allow you to place more resources, to help others.</p> <p>Start by placing some resources on the map. When you are ready, click the 'Play' button in the Control Panel on the left. After a few seconds, citizens will start marching towards their goal.</p> ");
PresetLevels.level0.setup=function(){this.fillWithTiles();this.clearTiles(20,5);this.clearTiles(15,1);this.clearTiles(10,5);this.clearTiles(9,1);this.clearTiles(0,5)};PresetLevels.level1=new Level(1);PresetLevels.level1.setPresetLevel(!0);PresetLevels.level1.addEntryPoint(0,9);PresetLevels.level1.addExitPoint(10,1);PresetLevels.level1.setWorldWidth(11);PresetLevels.level1.setWorldHeight(11);PresetLevels.level1.setInitialAgentNumber(1);PresetLevels.level1.setWaveNumber(10);PresetLevels.level1.setExpiryLimit(20);
PresetLevels.level1.setImage("http://2.bp.blogspot.com/_bxhbymaUoNY/TSRcmaTzelI/AAAAAAAAAF8/YlOvN46t5uA/s1600/City_Ruins_by_Natiq_Aghayev_aka_Defonten.jpg");PresetLevels.level1.setName("Level 1: Welcome to Fierce Planet!");PresetLevels.level1.setIntroduction("<p>The citizens of Fierce Planet are under threat of extinction. Cities have been destroyed, law and order has broken down, there is a shortage of food and water, and disease is rampant.</p><p>Help the citizens re-build their world before they are wiped out!</p>");
PresetLevels.level1.setConclusion("<p>Congratulations, you have helped the citizens start re-building... there is a long way to go!</p>");PresetLevels.level1.setTip(new Notice("Drag or click the resources on the right (->), then add them to the map.",FiercePlanet.WORLD_WIDTH-FiercePlanet.WAVE_NOTICE_WIDTH,FiercePlanet.WORLD_HEIGHT/2));PresetLevels.level1.setSoundSrc("/sounds/technophobic_android-creeping_0.mp3");
PresetLevels.level1.setup=function(){this.fillWithTiles();this.clearTiles(99,10);this.clearTiles(97,1);this.clearTiles(78,9);this.clearTiles(67,1);this.clearTiles(56,9);this.clearTiles(53,1);this.clearTiles(34,9);this.clearTiles(23,1);this.clearTiles(12,10);this.setLevelAgents([new Agent(AgentTypes.PREDATOR_AGENT_TYPE,0,9)]);this.setWaveAgents([new Agent(AgentTypes.RIVAL_AGENT_TYPE,10,1)])};PresetLevels.level2=new Level(2);PresetLevels.level2.setPresetLevel(!0);
PresetLevels.level2.addEntryPoint(0,0);PresetLevels.level2.addExitPoint(11,1);PresetLevels.level2.setWorldWidth(12);PresetLevels.level2.setWorldHeight(12);PresetLevels.level2.setInitialAgentNumber(1);PresetLevels.level2.setWaveNumber(10);PresetLevels.level2.setExpiryLimit(10);PresetLevels.level2.setInitialResourceStore(120);PresetLevels.level2.setImage("http://www.publicdomainpictures.net/pictures/7000/nahled/2504-127160623953YH.jpg");PresetLevels.level2.setName("Level 2: Twists and Turns");PresetLevels.level2.setIntroduction("<p>The citizens of Fierce Planet are slowly building their city. With your help they can make it a place of peace and prosperity.</p>");
PresetLevels.level2.setConclusion("<p>Congratulations, you have completed level 2. But the hard work must continue...</p>");PresetLevels.level2.setTip(new Notice("You can pause at any time to add resources. You can place more resources as you save citizens.",0,0));PresetLevels.level2.setSoundSrc("/sounds/22415__Charel_Sytze__pizzadelivery.mp3");
PresetLevels.level2.setup=function(){this.fillWithTiles();this.clearTiles(121,10);this.clearTiles(118,1);this.clearTiles(109,1);this.clearTiles(102,5);this.clearTiles(97,4);this.clearTiles(90,1);this.clearTiles(88,1);this.clearTiles(78,5);this.clearTiles(73,4);this.clearTiles(70,1);this.clearTiles(61,1);this.clearTiles(54,5);this.clearTiles(49,4);this.clearTiles(42,1);this.clearTiles(40,1);this.clearTiles(32,3);this.clearTiles(30,1);this.clearTiles(25,4);this.clearTiles(22,2);this.clearTiles(18,3);
this.clearTiles(13,1);this.clearTiles(0,2)};PresetLevels.level3=new Level(3);PresetLevels.level3.setPresetLevel(!0);PresetLevels.level3.addEntryPoint(5,12);PresetLevels.level3.addExitPoint(3,3);PresetLevels.level3.setWorldWidth(13);PresetLevels.level3.setWorldHeight(13);PresetLevels.level3.setInitialAgentNumber(1);PresetLevels.level3.setWaveNumber(10);PresetLevels.level3.setExpiryLimit(10);PresetLevels.level3.setInitialResourceStore(130);PresetLevels.level3.setImage("http://t1.gstatic.com/images?q=tbn:ANd9GcTPM0pPCj-LQNtsrdc1htNYinCKea9-JrAkGkNzZgzP1J26kmfNXA&t=1");
PresetLevels.level3.setName("Level 3: Waves of Uncertainty");PresetLevels.level3.setIntroduction("<p>The re-building of Fierce Planet is proceeding well\u2026but how can you plan for a random act of nature??!!! </p>");PresetLevels.level3.setConclusion("<p>Phew - that was a rush! Perhaps the citizens need to stay inland for a while.</p>");PresetLevels.level3.setTip(new Notice("Levels get progressively larger, requiring more planning about where you allocate resources. Aim to place resources at regular intervals."));
PresetLevels.level3.setSoundSrc("/sounds/22688__DJ_Chronos__Loop_1.mp3");PresetLevels.level3.setCatastrophe(new Catastrophe(FiercePlanet.resourceCategories[1],1E3+Math.random()*2E3,250,0,new Notice("A tsumani will soon hit the city - all resources will be depleted.",void 0,void 0,500,250)));
PresetLevels.level3.setup=function(){this.fillWithTiles();this.clearTiles(161,1);this.clearTiles(150,5);this.clearTiles(148,1);this.clearTiles(144,3);this.clearTiles(141,1);this.clearTiles(137,1);this.clearTiles(135,1);this.clearTiles(133,1);this.clearTiles(131,1);this.clearTiles(126,3);this.clearTiles(124,1);this.clearTiles(122,1);this.clearTiles(120,1);this.clearTiles(118,1);this.clearTiles(113,1);this.clearTiles(111,1);this.clearTiles(109,1);this.clearTiles(107,1);this.clearTiles(105,1);this.clearTiles(100,
3);this.clearTiles(96,3);this.clearTiles(94,1);this.clearTiles(92,1);this.clearTiles(89,1);this.clearTiles(81,1);this.clearTiles(79,1);this.clearTiles(68,9);this.clearTiles(66,1);this.clearTiles(53,1);this.clearTiles(42,9);this.clearTiles(40,1);this.clearTiles(37,1);this.clearTiles(27,1);this.clearTiles(14,11)};PresetLevels.level4=new Level(4);PresetLevels.level4.setPresetLevel(!0);PresetLevels.level4.addEntryPoint(6,6);PresetLevels.level4.addExitPoint(0,0);PresetLevels.level4.setWorldWidth(14);PresetLevels.level4.setWorldHeight(14);
PresetLevels.level4.setInitialAgentNumber(1);PresetLevels.level4.setWaveNumber(10);PresetLevels.level4.setExpiryLimit(10);PresetLevels.level4.setInitialResourceStore(150);PresetLevels.level4.setImage("http://www.publicdomainpictures.net/pictures/11000/nahled/night-in-the-city-21851292200793awk.jpg");PresetLevels.level4.setName("Level 4: Spiral of Doom");PresetLevels.level4.setIntroduction("<p>The only way out is via the long and winding road...</p>");PresetLevels.level4.setTip(new Notice("Be sure to allocate resources to the outer reaches of the path. Citizens run faster when there is less to go around..."));
PresetLevels.level4.setSoundSrc("/sounds/36604__Charel_Sytze__klokslagtwaalf.mp3");
PresetLevels.level4.setup=function(){this.fillWithTiles();this.clearTiles(168,13);this.clearTiles(166,1);this.clearTiles(154,1);this.clearTiles(152,1);this.clearTiles(142,9);this.clearTiles(140,1);this.clearTiles(138,1);this.clearTiles(136,1);this.clearTiles(128,1);this.clearTiles(126,1);this.clearTiles(124,1);this.clearTiles(122,1);this.clearTiles(116,5);this.clearTiles(114,1);this.clearTiles(112,1);this.clearTiles(110,1);this.clearTiles(108,1);this.clearTiles(106,1);this.clearTiles(102,1);this.clearTiles(100,
1);this.clearTiles(98,1);this.clearTiles(96,1);this.clearTiles(94,1);this.clearTiles(92,1);this.clearTiles(90,1);this.clearTiles(88,1);this.clearTiles(86,1);this.clearTiles(84,1);this.clearTiles(82,1);this.clearTiles(80,1);this.clearTiles(76,3);this.clearTiles(74,1);this.clearTiles(72,1);this.clearTiles(70,1);this.clearTiles(68,1);this.clearTiles(66,1);this.clearTiles(60,1);this.clearTiles(58,1);this.clearTiles(56,1);this.clearTiles(54,1);this.clearTiles(46,7);this.clearTiles(44,1);this.clearTiles(42,
1);this.clearTiles(40,1);this.clearTiles(30,1);this.clearTiles(28,1);this.clearTiles(16,11);this.clearTiles(14,1);this.clearTiles(0,1)};PresetLevels.level5=new Level(5);PresetLevels.level5.setPresetLevel(!0);PresetLevels.level5.addEntryPoint(13,0);PresetLevels.level5.addExitPoint(0,1);PresetLevels.level5.setWorldWidth(15);PresetLevels.level5.setWorldHeight(15);PresetLevels.level5.setInitialAgentNumber(1);PresetLevels.level5.setWaveNumber(10);PresetLevels.level5.setExpiryLimit(10);PresetLevels.level5.setInitialResourceStore(180);
PresetLevels.level5.setImage("http://www.publicdomainpictures.net/pictures/6000/nahled/2178-1267099526uOOY.jpg");PresetLevels.level5.setName("Level 5: A-mazing Grace");PresetLevels.level5.setIntroduction("<p>The citizens are - mistakenly? - hopeful that the promised land lies not too far ahead. If only they can find their way through...</p>");PresetLevels.level5.setTip(new Notice("Citizens are (sort of) smart - at forks in the road, they'll take the path which appears more plentiful. Place resources to help them choose the right path."));
PresetLevels.level5.setSoundSrc("/sounds/57714__DJ_Chronos__Metal_Atmosphere_001.mp3");
PresetLevels.level5.setup=function(){this.fillWithTiles();this.clearTiles(208,1);this.clearTiles(204,3);this.clearTiles(196,7);this.clearTiles(193,1);this.clearTiles(191,1);this.clearTiles(189,1);this.clearTiles(187,1);this.clearTiles(183,1);this.clearTiles(178,1);this.clearTiles(176,1);this.clearTiles(174,1);this.clearTiles(172,1);this.clearTiles(170,1);this.clearTiles(166,3);this.clearTiles(163,1);this.clearTiles(161,1);this.clearTiles(159,1);this.clearTiles(157,1);this.clearTiles(155,1);this.clearTiles(151,
1);this.clearTiles(148,1);this.clearTiles(146,1);this.clearTiles(144,1);this.clearTiles(142,1);this.clearTiles(140,1);this.clearTiles(138,1);this.clearTiles(136,1);this.clearTiles(131,3);this.clearTiles(129,1);this.clearTiles(127,1);this.clearTiles(125,1);this.clearTiles(123,1);this.clearTiles(121,1);this.clearTiles(118,1);this.clearTiles(114,1);this.clearTiles(112,1);this.clearTiles(110,1);this.clearTiles(108,1);this.clearTiles(106,1);this.clearTiles(103,1);this.clearTiles(99,3);this.clearTiles(95,
3);this.clearTiles(91,3);this.clearTiles(88,1);this.clearTiles(86,1);this.clearTiles(80,1);this.clearTiles(78,1);this.clearTiles(76,1);this.clearTiles(73,1);this.clearTiles(71,1);this.clearTiles(67,3);this.clearTiles(65,1);this.clearTiles(63,1);this.clearTiles(61,1);this.clearTiles(58,1);this.clearTiles(56,1);this.clearTiles(54,1);this.clearTiles(52,1);this.clearTiles(50,1);this.clearTiles(48,1);this.clearTiles(46,1);this.clearTiles(43,1);this.clearTiles(41,1);this.clearTiles(39,1);this.clearTiles(37,
1);this.clearTiles(35,1);this.clearTiles(33,1);this.clearTiles(28,1);this.clearTiles(24,3);this.clearTiles(20,3);this.clearTiles(15,4);this.clearTiles(13,1)};PresetLevels.level6=new Level(6);PresetLevels.level6.setPresetLevel(!0);PresetLevels.level6.addEntryPoint(0,1);PresetLevels.level6.addExitPoint(2,14);PresetLevels.level6.setWorldWidth(16);PresetLevels.level6.setWorldHeight(16);PresetLevels.level6.setInitialAgentNumber(1);PresetLevels.level6.setWaveNumber(10);PresetLevels.level6.setExpiryLimit(10);
PresetLevels.level6.setAllowOffscreenCycling(!0);PresetLevels.level6.setInitialResourceStore(250);PresetLevels.level6.setImage("http://www.publicdomainpictures.net/pictures/11000/nahled/city-pollution-2961292115826L7C.jpg");PresetLevels.level6.setName("Level 6: Dire Straits");PresetLevels.level6.setIntroduction("<p>Not there yet... This level looks well resourced - but your citizens will need them. </p>");PresetLevels.level6.setTip(new Notice("Clicking on an existing resource allows you to delete or upgrade it. An upgraded resource will dispense more health to citizens passing by."));
PresetLevels.level6.setSoundSrc("/sounds/76266__tallers__001_plaza_revolucio.mp3");
PresetLevels.level6.setup=function(){this.fillWithTiles();this.clearTiles(226,1);this.clearTiles(212,12);this.clearTiles(208,3);this.clearTiles(196,1);this.clearTiles(182,10);this.clearTiles(176,5);this.clearTiles(166,1);this.clearTiles(152,8);this.clearTiles(144,7);this.clearTiles(136,1);this.clearTiles(122,6);this.clearTiles(112,9);this.clearTiles(106,1);this.clearTiles(92,4);this.clearTiles(80,11);this.clearTiles(76,1);this.clearTiles(62,2);this.clearTiles(48,13);this.clearTiles(46,1);this.clearTiles(16,
15)};PresetLevels.level7=new Level(7);PresetLevels.level7.setPresetLevel(!0);PresetLevels.level7.setWorldWidth(17);PresetLevels.level7.setWorldHeight(17);PresetLevels.level7.addEntryPoint(0,8);PresetLevels.level7.addExitPoint(16,8);PresetLevels.level7.setInitialAgentNumber(1);PresetLevels.level7.setWaveNumber(10);PresetLevels.level7.setExpiryLimit(10);PresetLevels.level7.setAllowResourcesOnPath(!0);PresetLevels.level7.setInitialResourceStore(150);PresetLevels.level7.setImage("http://www.publicdomainpictures.net/pictures/4000/nahled/1453-1252053885sFox.jpg");
PresetLevels.level7.setName("Level 7: Like, Totally Random...");PresetLevels.level7.setIntroduction("<p>Ahead lies a vast and empty expanse. The citizens are understandably nervous. Left unaided, they will try not to backtrack, but could still find themselves hopelessly lost without your aid.</p>");PresetLevels.level7.setTip(new Notice("You can add resources to the paths (the white squares) on this level, to direct citizens to their goal."));PresetLevels.level7.setSoundSrc("/sounds/22698__DJ_Chronos__Loop_2.mp3");
PresetLevels.level7.setup=function(){this.fillWithTiles();this.clearTiles(280,1);this.clearTiles(262,3);this.clearTiles(244,5);this.clearTiles(226,7);this.clearTiles(208,9);this.clearTiles(190,11);this.clearTiles(172,13);this.clearTiles(154,15);this.clearTiles(136,17);this.clearTiles(120,15);this.clearTiles(104,13);this.clearTiles(88,11);this.clearTiles(72,9);this.clearTiles(56,7);this.clearTiles(40,5);this.clearTiles(24,3);this.clearTiles(8,1)};PresetLevels.level8=new Level(8);PresetLevels.level8.setPresetLevel(!0);
PresetLevels.level8.addEntryPoint(0,0);PresetLevels.level8.addExitPoint(17,17);PresetLevels.level8.setWorldWidth(18);PresetLevels.level8.setWorldHeight(18);PresetLevels.level8.setInitialAgentNumber(1);PresetLevels.level8.setWaveNumber(10);PresetLevels.level8.setExpiryLimit(10);PresetLevels.level8.setInitialResourceStore(200);PresetLevels.level8.setImage("http://www.publicdomainpictures.net/pictures/7000/nahled/2185-1271351380pptO.jpg");PresetLevels.level8.setName("Level 8: A Fork (or Two) in the Road");
PresetLevels.level8.setIntroduction("<p>Life for the citizens of Fierce Planet is never easy. Having escaped the perils of random wandering, here they are faced with many decisions about which way to turn.</p>");PresetLevels.level8.setTip(new Notice("You'll need to direct citizen through numerous forks in the road, with strategic allocation of resources. Beware: leave no path under-resourced!"));PresetLevels.level8.setSoundSrc("/sounds/46783__schokobeau__metropoetry.mp3");
PresetLevels.level8.setup=function(){this.fillWithTiles();this.clearTiles(322,2);this.clearTiles(289,16);this.clearTiles(286,1);this.clearTiles(271,1);this.clearTiles(255,14);this.clearTiles(253,1);this.clearTiles(250,1);this.clearTiles(248,1);this.clearTiles(246,1);this.clearTiles(237,1);this.clearTiles(235,1);this.clearTiles(232,1);this.clearTiles(230,1);this.clearTiles(221,8);this.clearTiles(219,1);this.clearTiles(217,1);this.clearTiles(214,1);this.clearTiles(212,1);this.clearTiles(210,1);this.clearTiles(203,
1);this.clearTiles(201,1);this.clearTiles(199,1);this.clearTiles(196,1);this.clearTiles(194,1);this.clearTiles(187,6);this.clearTiles(185,1);this.clearTiles(183,1);this.clearTiles(181,1);this.clearTiles(178,1);this.clearTiles(176,1);this.clearTiles(174,1);this.clearTiles(172,1);this.clearTiles(169,1);this.clearTiles(167,1);this.clearTiles(165,1);this.clearTiles(163,1);this.clearTiles(160,1);this.clearTiles(158,1);this.clearTiles(156,1);this.clearTiles(154,1);this.clearTiles(151,1);this.clearTiles(149,
1);this.clearTiles(147,1);this.clearTiles(145,1);this.clearTiles(142,1);this.clearTiles(140,1);this.clearTiles(138,1);this.clearTiles(131,6);this.clearTiles(129,1);this.clearTiles(127,1);this.clearTiles(124,1);this.clearTiles(122,1);this.clearTiles(120,1);this.clearTiles(113,1);this.clearTiles(111,1);this.clearTiles(109,1);this.clearTiles(106,1);this.clearTiles(104,1);this.clearTiles(95,8);this.clearTiles(93,1);this.clearTiles(91,1);this.clearTiles(88,1);this.clearTiles(86,1);this.clearTiles(77,1);
this.clearTiles(75,1);this.clearTiles(73,1);this.clearTiles(70,1);this.clearTiles(55,14);this.clearTiles(52,1);this.clearTiles(37,1);this.clearTiles(19,16);this.clearTiles(0,2)};PresetLevels.level9=new Level(9);PresetLevels.level9.setPresetLevel(!0);PresetLevels.level9.addEntryPoint(9,0);PresetLevels.level9.addExitPoint(9,18);PresetLevels.level9.setWorldWidth(19);PresetLevels.level9.setWorldHeight(19);PresetLevels.level9.setInitialAgentNumber(1);PresetLevels.level9.setWaveNumber(10);PresetLevels.level9.setExpiryLimit(10);
PresetLevels.level9.setImage("http://www.publicdomainpictures.net/pictures/8000/nahled/sailboats-218512787662477CFj.jpg");PresetLevels.level9.setName("Level 9: Cascades");PresetLevels.level9.setIntroduction("<p>With time running out, the citizens of Fierce Planet are in a rush to find safety. But they're in for a bumpy ride.</p>");PresetLevels.level9.setTip(new Notice("No tip! You've gotten this far..."));PresetLevels.level9.setSoundSrc("/sounds/26377__DJ_Chronos__Soundscape_2.mp3");
PresetLevels.level9.setup=function(){this.fillWithTiles();this.clearTiles(351,1);this.clearTiles(330,5);this.clearTiles(311,1);this.clearTiles(296,3);this.clearTiles(294,1);this.clearTiles(290,3);this.clearTiles(279,1);this.clearTiles(275,1);this.clearTiles(271,1);this.clearTiles(260,3);this.clearTiles(254,5);this.clearTiles(250,3);this.clearTiles(243,1);this.clearTiles(239,1);this.clearTiles(235,1);this.clearTiles(231,1);this.clearTiles(224,3);this.clearTiles(214,9);this.clearTiles(210,3);this.clearTiles(207,
1);this.clearTiles(203,1);this.clearTiles(195,1);this.clearTiles(191,1);this.clearTiles(182,7);this.clearTiles(178,1);this.clearTiles(172,5);this.clearTiles(163,1);this.clearTiles(159,1);this.clearTiles(144,3);this.clearTiles(138,3);this.clearTiles(127,1);this.clearTiles(125,1);this.clearTiles(121,1);this.clearTiles(119,1);this.clearTiles(108,3);this.clearTiles(106,1);this.clearTiles(102,1);this.clearTiles(98,3);this.clearTiles(91,1);this.clearTiles(87,1);this.clearTiles(83,1);this.clearTiles(79,
1);this.clearTiles(72,3);this.clearTiles(62,9);this.clearTiles(58,3);this.clearTiles(55,1);this.clearTiles(39,1);this.clearTiles(20,17);this.clearTiles(9,1)};PresetLevels.level10=new Level(10);PresetLevels.level10.setPresetLevel(!0);PresetLevels.level10.addEntryPoint(18,19);PresetLevels.level10.addExitPoint(16,19);PresetLevels.level10.setWorldWidth(20);PresetLevels.level10.setWorldHeight(20);PresetLevels.level10.setInitialAgentNumber(1);PresetLevels.level10.setWaveNumber(5);PresetLevels.level10.setExpiryLimit(1);
PresetLevels.level10.setInitialResourceStore(250);PresetLevels.level10.setImage("http://www.publicdomainpictures.net/pictures/9000/nahled/warsaw-city-centre-20851282410093J8WZ.jpg");PresetLevels.level10.setName("Level 10: Fields of Ma(i)ze");PresetLevels.level10.setIntroduction("<p>Nearly there! Pastures of plenty, and a new future, lie in store for the citizens of Fierce Planet. However the way ahead is full of false dawns. Can they navigate the treacherous maze?</p>");PresetLevels.level10.setTip(new Notice("Remember to resource dead end paths, or citizens will expire, dazed and confused..."));
PresetLevels.level10.setSoundSrc("/sounds/57714__DJ_Chronos__Metal_Atmosphere_001.mp3");
PresetLevels.level10.setup=function(){this.fillWithTiles();this.clearTiles(398,1);this.clearTiles(396,1);this.clearTiles(378,1);this.clearTiles(361,16);this.clearTiles(358,1);this.clearTiles(356,1);this.clearTiles(345,1);this.clearTiles(341,1);this.clearTiles(338,1);this.clearTiles(334,3);this.clearTiles(325,8);this.clearTiles(323,1);this.clearTiles(321,1);this.clearTiles(318,1);this.clearTiles(312,1);this.clearTiles(305,1);this.clearTiles(303,1);this.clearTiles(301,1);this.clearTiles(298,1);this.clearTiles(292,
5);this.clearTiles(287,4);this.clearTiles(285,1);this.clearTiles(281,3);this.clearTiles(278,1);this.clearTiles(267,1);this.clearTiles(265,1);this.clearTiles(247,12);this.clearTiles(241,5);this.clearTiles(238,1);this.clearTiles(221,1);this.clearTiles(218,1);this.clearTiles(215,1);this.clearTiles(211,3);this.clearTiles(207,3);this.clearTiles(205,1);this.clearTiles(203,1);this.clearTiles(201,1);this.clearTiles(195,4);this.clearTiles(193,1);this.clearTiles(189,3);this.clearTiles(183,5);this.clearTiles(181,
1);this.clearTiles(178,1);this.clearTiles(173,1);this.clearTiles(164,1);this.clearTiles(161,1);this.clearTiles(158,1);this.clearTiles(153,4);this.clearTiles(146,6);this.clearTiles(141,4);this.clearTiles(138,1);this.clearTiles(136,1);this.clearTiles(131,1);this.clearTiles(126,1);this.clearTiles(118,1);this.clearTiles(114,3);this.clearTiles(108,5);this.clearTiles(106,1);this.clearTiles(101,4);this.clearTiles(98,1);this.clearTiles(94,1);this.clearTiles(91,1);this.clearTiles(88,1);this.clearTiles(86,
1);this.clearTiles(84,1);this.clearTiles(81,1);this.clearTiles(78,1);this.clearTiles(76,1);this.clearTiles(71,4);this.clearTiles(68,2);this.clearTiles(63,4);this.clearTiles(61,1);this.clearTiles(58,1);this.clearTiles(56,1);this.clearTiles(41,1);this.clearTiles(21,18)};PresetLevels.level1.setMapOptions({latitude:47.5153,longitude:19.0782,zoom:18});PresetLevels.level2.setMapOptions({latitude:37.390296,longitude:-5.954579,zoom:18});
PresetLevels.level3.setMapOptions({latitude:45.433607,longitude:12.338124,zoom:18});PresetLevels.level4.setMapOptions({latitude:-33.909092,longitude:18.406061,zoom:18});PresetLevels.level5.setMapOptions({latitude:-33.434969,longitude:-70.655254});PresetLevels.level6.setMapOptions({latitude:47.487229,longitude:19.07513});PresetLevels.level7.setMapOptions({latitude:30.006533,longitude:-90.158792});PresetLevels.level8.setMapOptions({latitude:21.283355,longitude:-157.837787});
PresetLevels.level9.setMapOptions({latitude:33.441393,longitude:-112.077407});PresetLevels.level10.setMapOptions({latitude:30.265452,longitude:-97.744524,zoom:18});
