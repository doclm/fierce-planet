<%= form_for @level, :method => :put, :remote => true do |f| %>
    <%= f.hidden_field :tiles %>
    <%= f.hidden_field :entry_points %>
    <%= f.hidden_field :exit_points %>
    <%= f.hidden_field :world_width %>
    <%= f.hidden_field :world_height %>
    <%= f.hidden_field :initial_agent_x %>
    <%= f.hidden_field :initial_agent_y %>
    <%= f.hidden_field :goal_x %>
    <%= f.hidden_field :goal_y %>
    <%= f.hidden_field :image_src %>
    <%= f.submit 'Save Level' %>
<% end %>
<script>
    // attach a submit handler to the form
    $('.edit_level')[0].addEventListener('submit', function(event) {
        $('#level_tiles')[0].value = $.toJSON(currentLevel.getTiles());
        $('#level_entry_points')[0].value = $.toJSON(currentLevel.getEntryPoints());
        $('#level_exit_points')[0].value = $.toJSON(currentLevel.getExitPoints());
        $('#level_world_width')[0].value = currentLevel.getWorldWidth();
        $('#level_world_height')[0].value = currentLevel.getWorldHeight();
        $('#level_image_src')[0].value = currentLevel.getMapURL();
    });

    var levelTimerId = null;

    $(document).ready(function() {
        if (levelTimerId != undefined)
            clearInterval(levelTimerId);
        levelTimerId = setInterval("submitLevelForm()", 5000);
    });

    function submitLevelForm() {
        // TODO: Intercept the JQuery Ajax call here
//      $('.edit_level')[0].submit();
    }



</script>

